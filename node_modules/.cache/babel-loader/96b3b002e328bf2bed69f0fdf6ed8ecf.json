{"remainingRequest":"/Users/antonyching/Desktop/project/new-builder-demo/node_modules/babel-loader/lib/index.js!/Users/antonyching/Desktop/project/new-builder-demo/node_modules/@ckeditor/ckeditor5-typing/src/utils/injectunsafekeystrokeshandling.js","dependencies":[{"path":"/Users/antonyching/Desktop/project/new-builder-demo/node_modules/@ckeditor/ckeditor5-typing/src/utils/injectunsafekeystrokeshandling.js","mtime":499162500000},{"path":"/Users/antonyching/Desktop/project/new-builder-demo/node_modules/@ckeditor/ckeditor5-dev-webpack-plugin/lib/translatesourceloader.js","mtime":499162500000},{"path":"/Users/antonyching/Desktop/project/new-builder-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/antonyching/Desktop/project/new-builder-demo/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyoqCiAqIEBsaWNlbnNlIENvcHlyaWdodCAoYykgMjAwMy0yMDE5LCBDS1NvdXJjZSAtIEZyZWRlcmljbyBLbmFiYmVuLiBBbGwgcmlnaHRzIHJlc2VydmVkLgogKiBGb3IgbGljZW5zaW5nLCBzZWUgTElDRU5TRS5tZCBvciBodHRwczovL2NrZWRpdG9yLmNvbS9sZWdhbC9ja2VkaXRvci1vc3MtbGljZW5zZQogKi8KCi8qKgogKiBAbW9kdWxlIHR5cGluZy91dGlscy9pbmplY3R1bnNhZmVrZXlzdHJva2VzaGFuZGxpbmcKICovCmltcG9ydCB7IGdldENvZGUgfSBmcm9tICdAY2tlZGl0b3IvY2tlZGl0b3I1LXV0aWxzL3NyYy9rZXlib2FyZCc7CmltcG9ydCBlbnYgZnJvbSAnQGNrZWRpdG9yL2NrZWRpdG9yNS11dGlscy9zcmMvZW52JzsKLyoqCiAqIEhhbmRsZXMga2V5c3Ryb2tlcyB3aGljaCBhcmUgdW5zYWZlIGZvciB0eXBpbmcuIFRoaXMgaGFuZGxlcidzIGxvZ2ljIGlzIGV4cGxhaW5lZAogKiBpbiBodHRwczovL2dpdGh1Yi5jb20vY2tlZGl0b3IvY2tlZGl0b3I1LXR5cGluZy9pc3N1ZXMvODMjaXNzdWVjb21tZW50LTM5ODY5MDI1MS4KICoKICogQHBhcmFtIHttb2R1bGU6Y29yZS9lZGl0b3IvZWRpdG9yfkVkaXRvcn0gZWRpdG9yIFRoZSBlZGl0b3IgaW5zdGFuY2UuCiAqLwoKZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaW5qZWN0VW5zYWZlS2V5c3Ryb2tlc0hhbmRsaW5nKGVkaXRvcikgewogIGxldCBsYXRlc3RDb21wb3NpdGlvblNlbGVjdGlvbiA9IG51bGw7CiAgY29uc3QgbW9kZWwgPSBlZGl0b3IubW9kZWw7CiAgY29uc3QgdmlldyA9IGVkaXRvci5lZGl0aW5nLnZpZXc7CiAgY29uc3QgaW5wdXRDb21tYW5kID0gZWRpdG9yLmNvbW1hbmRzLmdldCgnaW5wdXQnKTsgLy8gRm9yIEFuZHJvaWQsIHdlIHdhbnQgdG8gaGFuZGxlIGtleXN0cm9rZXMgb24gYGJlZm9yZWlucHV0YCB0byBiZSBzdXJlIHRoYXQgY29kZSBpbiBgRGVsZXRlT2JzZXJ2ZXJgIGFscmVhZHkgaGFkIGEgY2hhbmNlIHRvIGJlIGZpcmVkLgoKICBpZiAoZW52LmlzQW5kcm9pZCkgewogICAgdmlldy5kb2N1bWVudC5vbignYmVmb3JlaW5wdXQnLCAoZXZ0LCBldnREYXRhKSA9PiBoYW5kbGVVbnNhZmVLZXlzdHJva2UoZXZ0RGF0YSksIHsKICAgICAgcHJpb3JpdHk6ICdsb3dlc3QnCiAgICB9KTsKICB9IGVsc2UgewogICAgdmlldy5kb2N1bWVudC5vbigna2V5ZG93bicsIChldnQsIGV2dERhdGEpID0+IGhhbmRsZVVuc2FmZUtleXN0cm9rZShldnREYXRhKSwgewogICAgICBwcmlvcml0eTogJ2xvd2VzdCcKICAgIH0pOwogIH0KCiAgdmlldy5kb2N1bWVudC5vbignY29tcG9zaXRpb25zdGFydCcsIGhhbmRsZUNvbXBvc2l0aW9uU3RhcnQsIHsKICAgIHByaW9yaXR5OiAnbG93ZXN0JwogIH0pOwogIHZpZXcuZG9jdW1lbnQub24oJ2NvbXBvc2l0aW9uZW5kJywgKCkgPT4gewogICAgbGF0ZXN0Q29tcG9zaXRpb25TZWxlY3Rpb24gPSBtb2RlbC5jcmVhdGVTZWxlY3Rpb24obW9kZWwuZG9jdW1lbnQuc2VsZWN0aW9uKTsKICB9LCB7CiAgICBwcmlvcml0eTogJ2xvd2VzdCcKICB9KTsgLy8gSGFuZGxlcyB0aGUga2V5ZG93biBldmVudC4gV2UgbmVlZCB0byBndWVzcyB3aGV0aGVyIHN1Y2gga2V5c3Ryb2tlIGlzIGdvaW5nIHRvIHJlc3VsdAogIC8vIGluIHR5cGluZy4gSWYgc28sIHRoZW4gYmVmb3JlIGNoYXJhY3RlciBpbnNlcnRpb24gaGFwcGVucywgYW55IHNlbGVjdGVkIGNvbnRlbnQgbmVlZHMKICAvLyB0byBiZSBkZWxldGVkLiBPdGhlcndpc2UgdGhlIGRlZmF1bHQgYnJvd3NlciBkZWxldGlvbiBtZWNoYW5pc20gd291bGQgYmUKICAvLyB0cmlnZ2VyZWQsIHJlc3VsdGluZyBpbjoKICAvLwogIC8vICogSHVuZHJlZHMgb2YgbXV0YXRpb25zIHdoaWNoIGNvdWxkIG5vdCBiZSBoYW5kbGVkLgogIC8vICogQnV0IG1vc3QgaW1wb3J0YW50bHksIGxvc3Mgb2YgY29udHJvbCBvdmVyIGhvdyB0aGUgY29udGVudCBpcyBiZWluZyBkZWxldGVkLgogIC8vCiAgLy8gVGhlIG1ldGhvZCBpcyB1c2VkIGluIGEgbG93LXByaW9yaXR5IGxpc3RlbmVyLCBoZW5jZSBhbGxvd2luZyBvdGhlciBsaXN0ZW5lcnMgKGUuZy4gZGVsZXRlIG9yIGVudGVyIGZlYXR1cmVzKQogIC8vIHRvIGhhbmRsZSB0aGUgZXZlbnQuCiAgLy8KICAvLyBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9vYnNlcnZlci9rZXlvYnNlcnZlcn5LZXlFdmVudERhdGF9IGV2dERhdGEKCiAgZnVuY3Rpb24gaGFuZGxlVW5zYWZlS2V5c3Ryb2tlKGV2dERhdGEpIHsKICAgIGNvbnN0IGRvYyA9IG1vZGVsLmRvY3VtZW50OwogICAgY29uc3QgaXNDb21wb3NpbmcgPSB2aWV3LmRvY3VtZW50LmlzQ29tcG9zaW5nOwogICAgY29uc3QgaXNTZWxlY3Rpb25VbmNoYW5nZWQgPSBsYXRlc3RDb21wb3NpdGlvblNlbGVjdGlvbiAmJiBsYXRlc3RDb21wb3NpdGlvblNlbGVjdGlvbi5pc0VxdWFsKGRvYy5zZWxlY3Rpb24pOyAvLyBSZXNldCBzdG9yZWQgY29tcG9zaXRpb24gc2VsZWN0aW9uLgoKICAgIGxhdGVzdENvbXBvc2l0aW9uU2VsZWN0aW9uID0gbnVsbDsgLy8gQnkgcmVseWluZyBvbiB0aGUgc3RhdGUgb2YgdGhlIGlucHV0IGNvbW1hbmQgd2UgYWxsb3cgZGlzYWJsaW5nIHRoZSBlbnRpcmUgaW5wdXQgZWFzaWx5CiAgICAvLyBieSBqdXN0IGRpc2FibGluZyB0aGUgaW5wdXQgY29tbWFuZC4gV2UgY291bGTigJl2ZSB1c2VkIGhlcmUgdGhlIGRlbGV0ZSBjb21tYW5kIGJ1dCB0aGF0CiAgICAvLyB3b3VsZCBtZWFuIHJlcXVpcmluZyB0aGUgZGVsZXRlIGZlYXR1cmUgd2hpY2ggd291bGQgYmxvY2sgbG9hZGluZyBvbmUgd2l0aG91dCB0aGUgb3RoZXIuCiAgICAvLyBXZSBjb3VsZCBhbHNvIGNoZWNrIHRoZSBlZGl0b3IuaXNSZWFkT25seSBwcm9wZXJ0eSwgYnV0IHRoYXQgd291bGRuJ3QgYWxsb3cgdG8gYmxvY2sKICAgIC8vIHRoZSBpbnB1dCB3aXRob3V0IGJsb2NraW5nIG90aGVyIGZlYXR1cmVzLgoKICAgIGlmICghaW5wdXRDb21tYW5kLmlzRW5hYmxlZCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKGlzU2FmZUtleXN0cm9rZShldnREYXRhKSB8fCBkb2Muc2VsZWN0aW9uLmlzQ29sbGFwc2VkKSB7CiAgICAgIHJldHVybjsKICAgIH0gLy8gSWYgZHVyaW5nIGNvbXBvc2l0aW9uLCBkZWxldGlvbiBzaG91bGQgYmUgcHJldmVudGVkIGFzIGl0IG1heSByZW1vdmUgY29tcG9zZWQgc2VxdWVuY2UgKCM4MykuCgoKICAgIGlmIChpc0NvbXBvc2luZyAmJiBldnREYXRhLmtleUNvZGUgPT09IDIyOSkgewogICAgICByZXR1cm47CiAgICB9IC8vIElmIHRoZXJlIGlzIGEgYGtleWRvd25gIGV2ZW50IGZpcmVkIHdpdGggJzIyOScga2V5Y29kZSBpdCBtaWdodCBiZSByZWxhdGVkCiAgICAvLyB0byByZWNlbnQgY29tcG9zaXRpb24uIENoZWNrIGlmIHNlbGVjdGlvbiBpcyB0aGUgc2FtZSBhcyB1cG9uIGVuZGluZyByZWNlbnQgY29tcG9zaXRpb24sCiAgICAvLyBpZiBzbyBkbyBub3QgcmVtb3ZlIHNlbGVjdGVkIGNvbnRlbnQgYXMgaXQgd2lsbCByZW1vdmUgY29tcG9zZWQgc2VxdWVuY2UgKCM4MykuCgoKICAgIGlmICghaXNDb21wb3NpbmcgJiYgZXZ0RGF0YS5rZXlDb2RlID09PSAyMjkgJiYgaXNTZWxlY3Rpb25VbmNoYW5nZWQpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGRlbGV0ZVNlbGVjdGlvbkNvbnRlbnQoKTsKICB9IC8vIEhhbmRsZXMgdGhlIGBjb21wb3NpdGlvbnN0YXJ0YCBldmVudC4gSXQgaXMgdXNlZCBvbmx5IGluIHNwZWNpYWwgY2FzZXMgdG8gcmVtb3ZlIHRoZSBjb250ZW50cwogIC8vIG9mIGEgbm9uLWNvbGxhcHNlZCBzZWxlY3Rpb24gc28gY29tcG9zaXRpb24gaXRzZWxmIGRvZXMgbm90IHJlc3VsdCBpbiBjb21wbGV4IG11dGF0aW9ucy4KICAvLwogIC8vIFRoZSBzcGVjaWFsIGNhc2UgbWVudGlvbmVkIGFib3ZlIGlzIGEgc2l0dWF0aW9uIGluIHdoaWNoIHRoZSBga2V5ZG93bmAgZXZlbnQgaXMgZmlyZWQgYWZ0ZXIKICAvLyBgY29tcG9zaXRpb25zdGFydGAgZXZlbnQuIEluIHN1Y2ggY2FzZXMge0BsaW5rICNoYW5kbGVLZXlkb3dufSBjYW5ub3QgY2xlYXIgY3VycmVudCBzZWxlY3Rpb24KICAvLyBjb250ZW50cyAoYmVjYXVzZSBpdCBpcyB0b28gbGF0ZSBhbmQgd2lsbCBicmVhayB0aGUgY29tcG9zaXRpb24pIHNvIHRoZSBjb21wb3NpdGlvbiBoYW5kbGVyIHRha2VzIGNhcmUgb2YgaXQuCgoKICBmdW5jdGlvbiBoYW5kbGVDb21wb3NpdGlvblN0YXJ0KCkgewogICAgY29uc3QgZG9jID0gbW9kZWwuZG9jdW1lbnQ7CiAgICBjb25zdCBpc0ZsYXRTZWxlY3Rpb24gPSBkb2Muc2VsZWN0aW9uLnJhbmdlQ291bnQgPT09IDEgPyBkb2Muc2VsZWN0aW9uLmdldEZpcnN0UmFuZ2UoKS5pc0ZsYXQgOiB0cnVlOyAvLyBJZiBvbiBgY29tcG9zaXRpb25zdGFydGAgdGhlcmUgaXMgYSBub24tY29sbGFwc2VkIHNlbGVjdGlvbiB3aGljaCBzdGFydCBhbmQgZW5kIGhhdmUgZGlmZmVyZW50IHBhcmVudHMKICAgIC8vIGl0IG1lYW5zIHRoZSBgaGFuZGxlS2V5ZG93bigpYCBtZXRob2QgZGlkIG5vdCByZW1vdmUgaXRzIGNvbnRlbnRzLiBJdCBoYXBwZW5zIHVzdWFsbHkgYmVjYXVzZQogICAgLy8gb2YgZGlmZmVyZW50IG9yZGVyIG9mIGV2ZW50cyAoYGNvbXBvc2l0aW9uc3RhcnRgIGJlZm9yZSBga2V5ZG93bmAgLSBpbiBTYWZhcmkpLiBJbiBzdWNoIGNhc2VzCiAgICAvLyB3ZSBuZWVkIHRvIHJlbW92ZSBzZWxlY3Rpb24gY29udGVudHMgb24gY29tcG9zaXRpb24gc3RhcnQgKCM4MykuCgogICAgaWYgKGRvYy5zZWxlY3Rpb24uaXNDb2xsYXBzZWQgfHwgaXNGbGF0U2VsZWN0aW9uKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBkZWxldGVTZWxlY3Rpb25Db250ZW50KCk7CiAgfQoKICBmdW5jdGlvbiBkZWxldGVTZWxlY3Rpb25Db250ZW50KCkgewogICAgY29uc3QgYnVmZmVyID0gaW5wdXRDb21tYW5kLmJ1ZmZlcjsKICAgIGJ1ZmZlci5sb2NrKCk7CiAgICBtb2RlbC5lbnF1ZXVlQ2hhbmdlKGJ1ZmZlci5iYXRjaCwgKCkgPT4gewogICAgICBtb2RlbC5kZWxldGVDb250ZW50KG1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbik7CiAgICB9KTsKICAgIGJ1ZmZlci51bmxvY2soKTsKICB9Cn0KY29uc3Qgc2FmZUtleWNvZGVzID0gW2dldENvZGUoJ2Fycm93VXAnKSwgZ2V0Q29kZSgnYXJyb3dSaWdodCcpLCBnZXRDb2RlKCdhcnJvd0Rvd24nKSwgZ2V0Q29kZSgnYXJyb3dMZWZ0JyksIDksIC8vIFRhYgoxNiwgLy8gU2hpZnQKMTcsIC8vIEN0cmwKMTgsIC8vIEFsdAoxOSwgLy8gUGF1c2UKMjAsIC8vIENhcHNMb2NrCjI3LCAvLyBFc2NhcGUKMzMsIC8vIFBhZ2VVcAozNCwgLy8gUGFnZURvd24KMzUsIC8vIEhvbWUKMzYsIC8vIEVuZCwKNDUsIC8vIEluc2VydCwKOTEsIC8vIFdpbmRvd3MsCjkzLCAvLyBNZW51IGtleSwKMTQ0LCAvLyBOdW1Mb2NrCjE0NSwgLy8gU2Nyb2xsTG9jaywKMTczLCAvLyBNdXRlL1VubXV0ZQoxNzQsIC8vIFZvbHVtZSB1cAoxNzUsIC8vIFZvbHVtZSBkb3duLAoxNzYsIC8vIE5leHQgc29uZywKMTc3LCAvLyBQcmV2aW91cyBzb25nLAoxNzgsIC8vIFN0b3AsCjE3OSwgLy8gUGxheS9QYXVzZSwKMjU1IC8vIERpc3BsYXkgYnJpZ2h0bmVzcyAoaW5jcmVhc2UgYW5kIGRlY3JlYXNlKQpdOyAvLyBGdW5jdGlvbiBrZXlzLgoKZm9yIChsZXQgY29kZSA9IDExMjsgY29kZSA8PSAxMzU7IGNvZGUrKykgewogIHNhZmVLZXljb2Rlcy5wdXNoKGNvZGUpOwp9IC8vIFJldHVybnMgYHRydWVgIGlmIGEga2V5c3Ryb2tlIHNob3VsZCBub3QgY2F1c2UgYW55IGNvbnRlbnQgY2hhbmdlIGNhdXNlZCBieSAidHlwaW5nIi4KLy8KLy8gTm90ZTogVGhpcyBpbXBsZW1lbnRhdGlvbiBpcyB2ZXJ5IHNpbXBsZSBhbmQgd2lsbCBuZWVkIHRvIGJlIHJlZmluZWQgd2l0aCB0aW1lLgovLwovLyBAcHJpdmF0ZQovLyBAcGFyYW0ge2VuZ2luZS52aWV3Lm9ic2VydmVyLmtleU9ic2VydmVyLktleUV2ZW50RGF0YX0ga2V5RGF0YQovLyBAcmV0dXJucyB7Qm9vbGVhbn0KCgpmdW5jdGlvbiBpc1NhZmVLZXlzdHJva2Uoa2V5RGF0YSkgewogIC8vIEtleXN0cm9rZXMgd2hpY2ggY29udGFpbiBDdHJsIGRvbid0IHJlcHJlc2VudCB0eXBpbmcuCiAgaWYgKGtleURhdGEuY3RybEtleSkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICByZXR1cm4gc2FmZUtleWNvZGVzLmluY2x1ZGVzKGtleURhdGEua2V5Q29kZSk7Cn0="},{"version":3,"sources":["/Users/antonyching/Desktop/project/new-builder-demo/node_modules/@ckeditor/ckeditor5-typing/src/utils/injectunsafekeystrokeshandling.js"],"names":["getCode","env","injectUnsafeKeystrokesHandling","editor","latestCompositionSelection","model","view","editing","inputCommand","commands","get","isAndroid","document","on","evt","evtData","handleUnsafeKeystroke","priority","handleCompositionStart","createSelection","selection","doc","isComposing","isSelectionUnchanged","isEqual","isEnabled","isSafeKeystroke","isCollapsed","keyCode","deleteSelectionContent","isFlatSelection","rangeCount","getFirstRange","isFlat","buffer","lock","enqueueChange","batch","deleteContent","unlock","safeKeycodes","code","push","keyData","ctrlKey","includes"],"mappings":"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","sourcesContent":["/**\n * @license Copyright (c) 2003-2019, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\n/**\n * @module typing/utils/injectunsafekeystrokeshandling\n */\n\nimport { getCode } from '@ckeditor/ckeditor5-utils/src/keyboard';\nimport env from '@ckeditor/ckeditor5-utils/src/env';\n\n/**\n * Handles keystrokes which are unsafe for typing. This handler's logic is explained\n * in https://github.com/ckeditor/ckeditor5-typing/issues/83#issuecomment-398690251.\n *\n * @param {module:core/editor/editor~Editor} editor The editor instance.\n */\nexport default function injectUnsafeKeystrokesHandling( editor ) {\n\tlet latestCompositionSelection = null;\n\n\tconst model = editor.model;\n\tconst view = editor.editing.view;\n\tconst inputCommand = editor.commands.get( 'input' );\n\n\t// For Android, we want to handle keystrokes on `beforeinput` to be sure that code in `DeleteObserver` already had a chance to be fired.\n\tif ( env.isAndroid ) {\n\t\tview.document.on( 'beforeinput', ( evt, evtData ) => handleUnsafeKeystroke( evtData ), { priority: 'lowest' } );\n\t} else {\n\t\tview.document.on( 'keydown', ( evt, evtData ) => handleUnsafeKeystroke( evtData ), { priority: 'lowest' } );\n\t}\n\n\tview.document.on( 'compositionstart', handleCompositionStart, { priority: 'lowest' } );\n\n\tview.document.on( 'compositionend', () => {\n\t\tlatestCompositionSelection = model.createSelection( model.document.selection );\n\t}, { priority: 'lowest' } );\n\n\t// Handles the keydown event. We need to guess whether such keystroke is going to result\n\t// in typing. If so, then before character insertion happens, any selected content needs\n\t// to be deleted. Otherwise the default browser deletion mechanism would be\n\t// triggered, resulting in:\n\t//\n\t// * Hundreds of mutations which could not be handled.\n\t// * But most importantly, loss of control over how the content is being deleted.\n\t//\n\t// The method is used in a low-priority listener, hence allowing other listeners (e.g. delete or enter features)\n\t// to handle the event.\n\t//\n\t// @param {module:engine/view/observer/keyobserver~KeyEventData} evtData\n\tfunction handleUnsafeKeystroke( evtData ) {\n\t\tconst doc = model.document;\n\t\tconst isComposing = view.document.isComposing;\n\t\tconst isSelectionUnchanged = latestCompositionSelection && latestCompositionSelection.isEqual( doc.selection );\n\n\t\t// Reset stored composition selection.\n\t\tlatestCompositionSelection = null;\n\n\t\t// By relying on the state of the input command we allow disabling the entire input easily\n\t\t// by just disabling the input command. We could’ve used here the delete command but that\n\t\t// would mean requiring the delete feature which would block loading one without the other.\n\t\t// We could also check the editor.isReadOnly property, but that wouldn't allow to block\n\t\t// the input without blocking other features.\n\t\tif ( !inputCommand.isEnabled ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( isSafeKeystroke( evtData ) || doc.selection.isCollapsed ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// If during composition, deletion should be prevented as it may remove composed sequence (#83).\n\t\tif ( isComposing && evtData.keyCode === 229 ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// If there is a `keydown` event fired with '229' keycode it might be related\n\t\t// to recent composition. Check if selection is the same as upon ending recent composition,\n\t\t// if so do not remove selected content as it will remove composed sequence (#83).\n\t\tif ( !isComposing && evtData.keyCode === 229 && isSelectionUnchanged ) {\n\t\t\treturn;\n\t\t}\n\n\t\tdeleteSelectionContent();\n\t}\n\n\t// Handles the `compositionstart` event. It is used only in special cases to remove the contents\n\t// of a non-collapsed selection so composition itself does not result in complex mutations.\n\t//\n\t// The special case mentioned above is a situation in which the `keydown` event is fired after\n\t// `compositionstart` event. In such cases {@link #handleKeydown} cannot clear current selection\n\t// contents (because it is too late and will break the composition) so the composition handler takes care of it.\n\tfunction handleCompositionStart() {\n\t\tconst doc = model.document;\n\t\tconst isFlatSelection = doc.selection.rangeCount === 1 ? doc.selection.getFirstRange().isFlat : true;\n\n\t\t// If on `compositionstart` there is a non-collapsed selection which start and end have different parents\n\t\t// it means the `handleKeydown()` method did not remove its contents. It happens usually because\n\t\t// of different order of events (`compositionstart` before `keydown` - in Safari). In such cases\n\t\t// we need to remove selection contents on composition start (#83).\n\t\tif ( doc.selection.isCollapsed || isFlatSelection ) {\n\t\t\treturn;\n\t\t}\n\n\t\tdeleteSelectionContent();\n\t}\n\n\tfunction deleteSelectionContent() {\n\t\tconst buffer = inputCommand.buffer;\n\n\t\tbuffer.lock();\n\n\t\tmodel.enqueueChange( buffer.batch, () => {\n\t\t\tmodel.deleteContent( model.document.selection );\n\t\t} );\n\n\t\tbuffer.unlock();\n\t}\n}\n\nconst safeKeycodes = [\n\tgetCode( 'arrowUp' ),\n\tgetCode( 'arrowRight' ),\n\tgetCode( 'arrowDown' ),\n\tgetCode( 'arrowLeft' ),\n\t9, // Tab\n\t16, // Shift\n\t17, // Ctrl\n\t18, // Alt\n\t19, // Pause\n\t20, // CapsLock\n\t27, // Escape\n\t33, // PageUp\n\t34, // PageDown\n\t35, // Home\n\t36, // End,\n\t45, // Insert,\n\t91, // Windows,\n\t93, // Menu key,\n\t144, // NumLock\n\t145, // ScrollLock,\n\t173, // Mute/Unmute\n\t174, // Volume up\n\t175, // Volume down,\n\t176, // Next song,\n\t177, // Previous song,\n\t178, // Stop,\n\t179, // Play/Pause,\n\t255 // Display brightness (increase and decrease)\n];\n\n// Function keys.\nfor ( let code = 112; code <= 135; code++ ) {\n\tsafeKeycodes.push( code );\n}\n\n// Returns `true` if a keystroke should not cause any content change caused by \"typing\".\n//\n// Note: This implementation is very simple and will need to be refined with time.\n//\n// @private\n// @param {engine.view.observer.keyObserver.KeyEventData} keyData\n// @returns {Boolean}\nfunction isSafeKeystroke( keyData ) {\n\t// Keystrokes which contain Ctrl don't represent typing.\n\tif ( keyData.ctrlKey ) {\n\t\treturn true;\n\t}\n\n\treturn safeKeycodes.includes( keyData.keyCode );\n}\n"]}]}