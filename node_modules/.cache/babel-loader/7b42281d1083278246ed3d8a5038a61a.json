{"remainingRequest":"/Users/antonyching/Desktop/project/new-builder-demo/node_modules/babel-loader/lib/index.js!/Users/antonyching/Desktop/project/new-builder-demo/node_modules/@ckeditor/ckeditor5-table/src/converters/downcast.js","dependencies":[{"path":"/Users/antonyching/Desktop/project/new-builder-demo/node_modules/@ckeditor/ckeditor5-table/src/converters/downcast.js","mtime":499162500000},{"path":"/Users/antonyching/Desktop/project/new-builder-demo/node_modules/@ckeditor/ckeditor5-dev-webpack-plugin/lib/translatesourceloader.js","mtime":499162500000},{"path":"/Users/antonyching/Desktop/project/new-builder-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/antonyching/Desktop/project/new-builder-demo/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyoqCiAqIEBsaWNlbnNlIENvcHlyaWdodCAoYykgMjAwMy0yMDE5LCBDS1NvdXJjZSAtIEZyZWRlcmljbyBLbmFiYmVuLiBBbGwgcmlnaHRzIHJlc2VydmVkLgogKiBGb3IgbGljZW5zaW5nLCBzZWUgTElDRU5TRS5tZCBvciBodHRwczovL2NrZWRpdG9yLmNvbS9sZWdhbC9ja2VkaXRvci1vc3MtbGljZW5zZQogKi8KCi8qKgogKiBAbW9kdWxlIHRhYmxlL2NvbnZlcnRlcnMvZG93bmNhc3QKICovCmltcG9ydCBUYWJsZVdhbGtlciBmcm9tICcuLy4uL3RhYmxld2Fsa2VyJzsKaW1wb3J0IHsgdG9XaWRnZXRFZGl0YWJsZSB9IGZyb20gJ0Bja2VkaXRvci9ja2VkaXRvcjUtd2lkZ2V0L3NyYy91dGlscyc7CmltcG9ydCB7IHRvVGFibGVXaWRnZXQgfSBmcm9tICcuLi91dGlscyc7Ci8qKgogKiBNb2RlbCB0YWJsZSBlbGVtZW50IHRvIHZpZXcgdGFibGUgZWxlbWVudCBjb252ZXJzaW9uIGhlbHBlci4KICoKICogVGhpcyBjb252ZXJzaW9uIGhlbHBlciBjcmVhdGVzIHRoZSB3aG9sZSB0YWJsZSBlbGVtZW50IHdpdGggY2hpbGQgZWxlbWVudHMuCiAqCiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zCiAqIEBwYXJhbSB7Qm9vbGVhbn0gb3B0aW9ucy5hc1dpZGdldCBJZiBzZXQgdG8gYHRydWVgLCB0aGUgZG93bmNhc3QgY29udmVyc2lvbiB3aWxsIHByb2R1Y2UgYSB3aWRnZXQuCiAqIEByZXR1cm5zIHtGdW5jdGlvbn0gQ29udmVyc2lvbiBoZWxwZXIuCiAqLwoKZXhwb3J0IGZ1bmN0aW9uIGRvd25jYXN0SW5zZXJ0VGFibGUob3B0aW9ucyA9IHt9KSB7CiAgcmV0dXJuIGRpc3BhdGNoZXIgPT4gZGlzcGF0Y2hlci5vbignaW5zZXJ0OnRhYmxlJywgKGV2dCwgZGF0YSwgY29udmVyc2lvbkFwaSkgPT4gewogICAgY29uc3QgdGFibGUgPSBkYXRhLml0ZW07CgogICAgaWYgKCFjb252ZXJzaW9uQXBpLmNvbnN1bWFibGUuY29uc3VtZSh0YWJsZSwgJ2luc2VydCcpKSB7CiAgICAgIHJldHVybjsKICAgIH0gLy8gQ29uc3VtZSBhdHRyaWJ1dGVzIGlmIHByZXNlbnQgdG8gbm90IGZpcmUgYXR0cmlidXRlIGNoYW5nZSBkb3duY2FzdAoKCiAgICBjb252ZXJzaW9uQXBpLmNvbnN1bWFibGUuY29uc3VtZSh0YWJsZSwgJ2F0dHJpYnV0ZTpoZWFkaW5nUm93czp0YWJsZScpOwogICAgY29udmVyc2lvbkFwaS5jb25zdW1hYmxlLmNvbnN1bWUodGFibGUsICdhdHRyaWJ1dGU6aGVhZGluZ0NvbHVtbnM6dGFibGUnKTsKICAgIGNvbnN0IGFzV2lkZ2V0ID0gb3B0aW9ucyAmJiBvcHRpb25zLmFzV2lkZ2V0OwogICAgY29uc3QgZmlndXJlRWxlbWVudCA9IGNvbnZlcnNpb25BcGkud3JpdGVyLmNyZWF0ZUNvbnRhaW5lckVsZW1lbnQoJ2ZpZ3VyZScsIHsKICAgICAgY2xhc3M6ICd0YWJsZScKICAgIH0pOwogICAgY29uc3QgdGFibGVFbGVtZW50ID0gY29udmVyc2lvbkFwaS53cml0ZXIuY3JlYXRlQ29udGFpbmVyRWxlbWVudCgndGFibGUnKTsKICAgIGNvbnZlcnNpb25BcGkud3JpdGVyLmluc2VydChjb252ZXJzaW9uQXBpLndyaXRlci5jcmVhdGVQb3NpdGlvbkF0KGZpZ3VyZUVsZW1lbnQsIDApLCB0YWJsZUVsZW1lbnQpOwogICAgbGV0IHRhYmxlV2lkZ2V0OwoKICAgIGlmIChhc1dpZGdldCkgewogICAgICB0YWJsZVdpZGdldCA9IHRvVGFibGVXaWRnZXQoZmlndXJlRWxlbWVudCwgY29udmVyc2lvbkFwaS53cml0ZXIpOwogICAgfQoKICAgIGNvbnN0IHRhYmxlV2Fsa2VyID0gbmV3IFRhYmxlV2Fsa2VyKHRhYmxlKTsKICAgIGNvbnN0IHRhYmxlQXR0cmlidXRlcyA9IHsKICAgICAgaGVhZGluZ1Jvd3M6IHRhYmxlLmdldEF0dHJpYnV0ZSgnaGVhZGluZ1Jvd3MnKSB8fCAwLAogICAgICBoZWFkaW5nQ29sdW1uczogdGFibGUuZ2V0QXR0cmlidXRlKCdoZWFkaW5nQ29sdW1ucycpIHx8IDAKICAgIH07IC8vIENhY2hlIGZvciBjcmVhdGVkIHRhYmxlIHJvd3MuCgogICAgY29uc3Qgdmlld1Jvd3MgPSBuZXcgTWFwKCk7CgogICAgZm9yIChjb25zdCB0YWJsZVdhbGtlclZhbHVlIG9mIHRhYmxlV2Fsa2VyKSB7CiAgICAgIGNvbnN0IHsKICAgICAgICByb3csCiAgICAgICAgY2VsbAogICAgICB9ID0gdGFibGVXYWxrZXJWYWx1ZTsKICAgICAgY29uc3QgdGFibGVTZWN0aW9uID0gZ2V0T3JDcmVhdGVUYWJsZVNlY3Rpb24oZ2V0U2VjdGlvbk5hbWUocm93LCB0YWJsZUF0dHJpYnV0ZXMpLCB0YWJsZUVsZW1lbnQsIGNvbnZlcnNpb25BcGkpOwogICAgICBjb25zdCB0YWJsZVJvdyA9IHRhYmxlLmdldENoaWxkKHJvdyk7CiAgICAgIGNvbnN0IHRyRWxlbWVudCA9IHZpZXdSb3dzLmdldChyb3cpIHx8IGNyZWF0ZVRyKHRhYmxlUm93LCByb3csIHRhYmxlU2VjdGlvbiwgY29udmVyc2lvbkFwaSk7CiAgICAgIHZpZXdSb3dzLnNldChyb3csIHRyRWxlbWVudCk7IC8vIENvbnN1bWUgdGFibGUgY2VsbCAtIGl0IHdpbGwgYmUgYWx3YXlzIGNvbnN1bWVkIGFzIHdlIGNvbnZlcnQgd2hvbGUgdGFibGUgYXQgb25jZS4KCiAgICAgIGNvbnZlcnNpb25BcGkuY29uc3VtYWJsZS5jb25zdW1lKGNlbGwsICdpbnNlcnQnKTsKICAgICAgY29uc3QgaW5zZXJ0UG9zaXRpb24gPSBjb252ZXJzaW9uQXBpLndyaXRlci5jcmVhdGVQb3NpdGlvbkF0KHRyRWxlbWVudCwgJ2VuZCcpOwogICAgICBjcmVhdGVWaWV3VGFibGVDZWxsRWxlbWVudCh0YWJsZVdhbGtlclZhbHVlLCB0YWJsZUF0dHJpYnV0ZXMsIGluc2VydFBvc2l0aW9uLCBjb252ZXJzaW9uQXBpLCBvcHRpb25zKTsKICAgIH0KCiAgICBjb25zdCB2aWV3UG9zaXRpb24gPSBjb252ZXJzaW9uQXBpLm1hcHBlci50b1ZpZXdQb3NpdGlvbihkYXRhLnJhbmdlLnN0YXJ0KTsKICAgIGNvbnZlcnNpb25BcGkubWFwcGVyLmJpbmRFbGVtZW50cyh0YWJsZSwgYXNXaWRnZXQgPyB0YWJsZVdpZGdldCA6IGZpZ3VyZUVsZW1lbnQpOwogICAgY29udmVyc2lvbkFwaS53cml0ZXIuaW5zZXJ0KHZpZXdQb3NpdGlvbiwgYXNXaWRnZXQgPyB0YWJsZVdpZGdldCA6IGZpZ3VyZUVsZW1lbnQpOwogIH0pOwp9Ci8qKgogKiBNb2RlbCByb3cgZWxlbWVudCB0byB2aWV3IGA8dHI+YCBlbGVtZW50IGNvbnZlcnNpb24gaGVscGVyLgogKgogKiBUaGlzIGNvbnZlcnNpb24gaGVscGVyIGNyZWF0ZXMgdGhlIHdob2xlIGA8dHI+YCBlbGVtZW50IHdpdGggY2hpbGQgZWxlbWVudHMuCiAqCiAqIEByZXR1cm5zIHtGdW5jdGlvbn0gQ29udmVyc2lvbiBoZWxwZXIuCiAqLwoKZXhwb3J0IGZ1bmN0aW9uIGRvd25jYXN0SW5zZXJ0Um93KG9wdGlvbnMgPSB7fSkgewogIHJldHVybiBkaXNwYXRjaGVyID0+IGRpc3BhdGNoZXIub24oJ2luc2VydDp0YWJsZVJvdycsIChldnQsIGRhdGEsIGNvbnZlcnNpb25BcGkpID0+IHsKICAgIGNvbnN0IHRhYmxlUm93ID0gZGF0YS5pdGVtOwoKICAgIGlmICghY29udmVyc2lvbkFwaS5jb25zdW1hYmxlLmNvbnN1bWUodGFibGVSb3csICdpbnNlcnQnKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgdGFibGUgPSB0YWJsZVJvdy5wYXJlbnQ7CiAgICBjb25zdCBmaWd1cmVFbGVtZW50ID0gY29udmVyc2lvbkFwaS5tYXBwZXIudG9WaWV3RWxlbWVudCh0YWJsZSk7CiAgICBjb25zdCB0YWJsZUVsZW1lbnQgPSBnZXRWaWV3VGFibGUoZmlndXJlRWxlbWVudCk7CiAgICBjb25zdCByb3cgPSB0YWJsZS5nZXRDaGlsZEluZGV4KHRhYmxlUm93KTsKICAgIGNvbnN0IHRhYmxlV2Fsa2VyID0gbmV3IFRhYmxlV2Fsa2VyKHRhYmxlLCB7CiAgICAgIHN0YXJ0Um93OiByb3csCiAgICAgIGVuZFJvdzogcm93CiAgICB9KTsKICAgIGNvbnN0IHRhYmxlQXR0cmlidXRlcyA9IHsKICAgICAgaGVhZGluZ1Jvd3M6IHRhYmxlLmdldEF0dHJpYnV0ZSgnaGVhZGluZ1Jvd3MnKSB8fCAwLAogICAgICBoZWFkaW5nQ29sdW1uczogdGFibGUuZ2V0QXR0cmlidXRlKCdoZWFkaW5nQ29sdW1ucycpIHx8IDAKICAgIH07IC8vIENhY2hlIGZvciBjcmVhdGVkIHRhYmxlIHJvd3MuCgogICAgY29uc3Qgdmlld1Jvd3MgPSBuZXcgTWFwKCk7CgogICAgZm9yIChjb25zdCB0YWJsZVdhbGtlclZhbHVlIG9mIHRhYmxlV2Fsa2VyKSB7CiAgICAgIGNvbnN0IHRhYmxlU2VjdGlvbiA9IGdldE9yQ3JlYXRlVGFibGVTZWN0aW9uKGdldFNlY3Rpb25OYW1lKHJvdywgdGFibGVBdHRyaWJ1dGVzKSwgdGFibGVFbGVtZW50LCBjb252ZXJzaW9uQXBpKTsKICAgICAgY29uc3QgdHJFbGVtZW50ID0gdmlld1Jvd3MuZ2V0KHJvdykgfHwgY3JlYXRlVHIodGFibGVSb3csIHJvdywgdGFibGVTZWN0aW9uLCBjb252ZXJzaW9uQXBpKTsKICAgICAgdmlld1Jvd3Muc2V0KHJvdywgdHJFbGVtZW50KTsgLy8gQ29uc3VtZSB0YWJsZSBjZWxsIC0gaXQgd2lsbCBiZSBhbHdheXMgY29uc3VtZWQgYXMgd2UgY29udmVydCB3aG9sZSByb3cgYXQgb25jZS4KCiAgICAgIGNvbnZlcnNpb25BcGkuY29uc3VtYWJsZS5jb25zdW1lKHRhYmxlV2Fsa2VyVmFsdWUuY2VsbCwgJ2luc2VydCcpOwogICAgICBjb25zdCBpbnNlcnRQb3NpdGlvbiA9IGNvbnZlcnNpb25BcGkud3JpdGVyLmNyZWF0ZVBvc2l0aW9uQXQodHJFbGVtZW50LCAnZW5kJyk7CiAgICAgIGNyZWF0ZVZpZXdUYWJsZUNlbGxFbGVtZW50KHRhYmxlV2Fsa2VyVmFsdWUsIHRhYmxlQXR0cmlidXRlcywgaW5zZXJ0UG9zaXRpb24sIGNvbnZlcnNpb25BcGksIG9wdGlvbnMpOwogICAgfQogIH0pOwp9Ci8qKgogKiBNb2RlbCB0YWJsZSBjZWxsIGVsZW1lbnQgdG8gdmlldyBgPHRkPmAgb3IgYDx0aD5gIGVsZW1lbnQgY29udmVyc2lvbiBoZWxwZXIuCiAqCiAqIFRoaXMgY29udmVyc2lvbiBoZWxwZXIgd2lsbCBjcmVhdGUgcHJvcGVyIGA8dGg+YCBlbGVtZW50cyBmb3IgdGFibGUgY2VsbHMgdGhhdCBhcmUgaW4gdGhlIGhlYWRpbmcgc2VjdGlvbiAoaGVhZGluZyByb3cgb3IgY29sdW1uKQogKiBhbmQgYDx0ZD5gIG90aGVyd2lzZS4KICoKICogQHJldHVybnMge0Z1bmN0aW9ufSBDb252ZXJzaW9uIGhlbHBlci4KICovCgpleHBvcnQgZnVuY3Rpb24gZG93bmNhc3RJbnNlcnRDZWxsKG9wdGlvbnMgPSB7fSkgewogIHJldHVybiBkaXNwYXRjaGVyID0+IGRpc3BhdGNoZXIub24oJ2luc2VydDp0YWJsZUNlbGwnLCAoZXZ0LCBkYXRhLCBjb252ZXJzaW9uQXBpKSA9PiB7CiAgICBjb25zdCB0YWJsZUNlbGwgPSBkYXRhLml0ZW07CgogICAgaWYgKCFjb252ZXJzaW9uQXBpLmNvbnN1bWFibGUuY29uc3VtZSh0YWJsZUNlbGwsICdpbnNlcnQnKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgdGFibGVSb3cgPSB0YWJsZUNlbGwucGFyZW50OwogICAgY29uc3QgdGFibGUgPSB0YWJsZVJvdy5wYXJlbnQ7CiAgICBjb25zdCByb3dJbmRleCA9IHRhYmxlLmdldENoaWxkSW5kZXgodGFibGVSb3cpOwogICAgY29uc3QgdGFibGVXYWxrZXIgPSBuZXcgVGFibGVXYWxrZXIodGFibGUsIHsKICAgICAgc3RhcnRSb3c6IHJvd0luZGV4LAogICAgICBlbmRSb3c6IHJvd0luZGV4CiAgICB9KTsKICAgIGNvbnN0IHRhYmxlQXR0cmlidXRlcyA9IHsKICAgICAgaGVhZGluZ1Jvd3M6IHRhYmxlLmdldEF0dHJpYnV0ZSgnaGVhZGluZ1Jvd3MnKSB8fCAwLAogICAgICBoZWFkaW5nQ29sdW1uczogdGFibGUuZ2V0QXR0cmlidXRlKCdoZWFkaW5nQ29sdW1ucycpIHx8IDAKICAgIH07IC8vIFdlIG5lZWQgdG8gaXRlcmF0ZSBvdmVyIGEgdGFibGUgaW4gb3JkZXIgdG8gZ2V0IHByb3BlciByb3cgJiBjb2x1bW4gdmFsdWVzIGZyb20gYSB3YWxrZXIKCiAgICBmb3IgKGNvbnN0IHRhYmxlV2Fsa2VyVmFsdWUgb2YgdGFibGVXYWxrZXIpIHsKICAgICAgaWYgKHRhYmxlV2Fsa2VyVmFsdWUuY2VsbCA9PT0gdGFibGVDZWxsKSB7CiAgICAgICAgY29uc3QgdHJFbGVtZW50ID0gY29udmVyc2lvbkFwaS5tYXBwZXIudG9WaWV3RWxlbWVudCh0YWJsZVJvdyk7CiAgICAgICAgY29uc3QgaW5zZXJ0UG9zaXRpb24gPSBjb252ZXJzaW9uQXBpLndyaXRlci5jcmVhdGVQb3NpdGlvbkF0KHRyRWxlbWVudCwgdGFibGVSb3cuZ2V0Q2hpbGRJbmRleCh0YWJsZUNlbGwpKTsKICAgICAgICBjcmVhdGVWaWV3VGFibGVDZWxsRWxlbWVudCh0YWJsZVdhbGtlclZhbHVlLCB0YWJsZUF0dHJpYnV0ZXMsIGluc2VydFBvc2l0aW9uLCBjb252ZXJzaW9uQXBpLCBvcHRpb25zKTsgLy8gTm8gbmVlZCB0byBpdGVyYXRlIGZ1cnRoZXIuCgogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfQogIH0pOwp9Ci8qKgogKiBDb252ZXJzaW9uIGhlbHBlciB0aGF0IGFjdHMgb24gaGVhZGluZyByb3dzIHRhYmxlIGF0dHJpYnV0ZSBjaGFuZ2UuCiAqCiAqIFRoaXMgY29udmVydGVyIHdpbGw6CiAqCiAqICogUmVuYW1lIGA8dGQ+YCB0byBgPHRoPmAgZWxlbWVudHMgb3IgdmljZSB2ZXJzYSBkZXBlbmRpbmcgb24gaGVhZGluZ3MuCiAqICogQ3JlYXRlIGA8dGhlYWQ+YCBvciBgPHRib2R5PmAgZWxlbWVudHMgaWYgbmVlZGVkLgogKiAqIFJlbW92ZSBlbXB0eSBgPHRoZWFkPmAgb3IgYDx0Ym9keT5gIGlmIG5lZWRlZC4KICoKICogQHJldHVybnMge0Z1bmN0aW9ufSBDb252ZXJzaW9uIGhlbHBlci4KICovCgpleHBvcnQgZnVuY3Rpb24gZG93bmNhc3RUYWJsZUhlYWRpbmdSb3dzQ2hhbmdlKG9wdGlvbnMgPSB7fSkgewogIGNvbnN0IGFzV2lkZ2V0ID0gISFvcHRpb25zLmFzV2lkZ2V0OwogIHJldHVybiBkaXNwYXRjaGVyID0+IGRpc3BhdGNoZXIub24oJ2F0dHJpYnV0ZTpoZWFkaW5nUm93czp0YWJsZScsIChldnQsIGRhdGEsIGNvbnZlcnNpb25BcGkpID0+IHsKICAgIGNvbnN0IHRhYmxlID0gZGF0YS5pdGVtOwoKICAgIGlmICghY29udmVyc2lvbkFwaS5jb25zdW1hYmxlLmNvbnN1bWUoZGF0YS5pdGVtLCBldnQubmFtZSkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGZpZ3VyZUVsZW1lbnQgPSBjb252ZXJzaW9uQXBpLm1hcHBlci50b1ZpZXdFbGVtZW50KHRhYmxlKTsKICAgIGNvbnN0IHZpZXdUYWJsZSA9IGdldFZpZXdUYWJsZShmaWd1cmVFbGVtZW50KTsKICAgIGNvbnN0IG9sZFJvd3MgPSBkYXRhLmF0dHJpYnV0ZU9sZFZhbHVlOwogICAgY29uc3QgbmV3Um93cyA9IGRhdGEuYXR0cmlidXRlTmV3VmFsdWU7IC8vIFRoZSBoZWFkIHNlY3Rpb24gaGFzIGdyb3duIHNvIG1vdmUgcm93cyBmcm9tIDx0Ym9keT4gdG8gPHRoZWFkPi4KCiAgICBpZiAobmV3Um93cyA+IG9sZFJvd3MpIHsKICAgICAgLy8gRmlsdGVyIG91dCBvbmx5IHRob3NlIHJvd3MgdGhhdCBhcmUgaW4gd3Jvbmcgc2VjdGlvbi4KICAgICAgY29uc3Qgcm93c1RvTW92ZSA9IEFycmF5LmZyb20odGFibGUuZ2V0Q2hpbGRyZW4oKSkuZmlsdGVyKCh7CiAgICAgICAgaW5kZXgKICAgICAgfSkgPT4gaXNCZXR3ZWVuKGluZGV4LCBvbGRSb3dzIC0gMSwgbmV3Um93cykpOwogICAgICBjb25zdCB2aWV3VGFibGVIZWFkID0gZ2V0T3JDcmVhdGVUYWJsZVNlY3Rpb24oJ3RoZWFkJywgdmlld1RhYmxlLCBjb252ZXJzaW9uQXBpKTsKICAgICAgbW92ZVZpZXdSb3dzVG9UYWJsZVNlY3Rpb24ocm93c1RvTW92ZSwgdmlld1RhYmxlSGVhZCwgY29udmVyc2lvbkFwaSwgJ2VuZCcpOyAvLyBSZW5hbWUgYWxsIHRhYmxlIGNlbGxzIGZyb20gbW92ZWQgcm93cyB0byAndGgnIGFzIHRoZXkgbGFuZHMgaW4gPHRoZWFkPi4KCiAgICAgIGZvciAoY29uc3QgdGFibGVSb3cgb2Ygcm93c1RvTW92ZSkgewogICAgICAgIGZvciAoY29uc3QgdGFibGVDZWxsIG9mIHRhYmxlUm93LmdldENoaWxkcmVuKCkpIHsKICAgICAgICAgIHJlbmFtZVZpZXdUYWJsZUNlbGwodGFibGVDZWxsLCAndGgnLCBjb252ZXJzaW9uQXBpLCBhc1dpZGdldCk7CiAgICAgICAgfQogICAgICB9IC8vIENsZWFudXA6IHRoaXMgd2lsbCByZW1vdmUgYW55IGVtcHR5IHNlY3Rpb24gZnJvbSB0aGUgdmlldyB3aGljaCBtYXkgaGFwcGVuIHdoZW4gbW92aW5nIGFsbCByb3dzIGZyb20gYSB0YWJsZSBzZWN0aW9uLgoKCiAgICAgIHJlbW92ZVRhYmxlU2VjdGlvbklmRW1wdHkoJ3Rib2R5Jywgdmlld1RhYmxlLCBjb252ZXJzaW9uQXBpKTsKICAgIH0gLy8gVGhlIGhlYWQgc2VjdGlvbiBoYXMgc2hydW5rIHNvIG1vdmUgcm93cyBmcm9tIDx0aGVhZD4gdG8gPHRib2R5Pi4KICAgIGVsc2UgewogICAgICAgIC8vIEZpbHRlciBvdXQgb25seSB0aG9zZSByb3dzIHRoYXQgYXJlIGluIHdyb25nIHNlY3Rpb24uCiAgICAgICAgY29uc3Qgcm93c1RvTW92ZSA9IEFycmF5LmZyb20odGFibGUuZ2V0Q2hpbGRyZW4oKSkuZmlsdGVyKCh7CiAgICAgICAgICBpbmRleAogICAgICAgIH0pID0+IGlzQmV0d2VlbihpbmRleCwgbmV3Um93cyAtIDEsIG9sZFJvd3MpKS5yZXZlcnNlKCk7IC8vIFRoZSByb3dzIHdpbGwgYmUgbW92ZWQgZnJvbSA8dGhlYWQ+IHRvIDx0Ym9keT4gaW4gcmV2ZXJzZSBvcmRlciBhdCB0aGUgYmVnaW5uaW5nIG9mIGEgPHRib2R5Pi4KCiAgICAgICAgY29uc3Qgdmlld1RhYmxlQm9keSA9IGdldE9yQ3JlYXRlVGFibGVTZWN0aW9uKCd0Ym9keScsIHZpZXdUYWJsZSwgY29udmVyc2lvbkFwaSk7CiAgICAgICAgbW92ZVZpZXdSb3dzVG9UYWJsZVNlY3Rpb24ocm93c1RvTW92ZSwgdmlld1RhYmxlQm9keSwgY29udmVyc2lvbkFwaSwgMCk7IC8vIENoZWNrIGlmIGNlbGxzIG1vdmVkIGZyb20gPHRoZWFkPiB0byA8dGJvZHk+IHJlcXVpcmVzIHJlbmFtaW5nIHRvIDx0ZD4gYXMgdGhpcyBkZXBlbmRzIG9uIGN1cnJlbnQgaGVhZGluZyBjb2x1bW5zIGF0dHJpYnV0ZS4KCiAgICAgICAgY29uc3QgdGFibGVXYWxrZXIgPSBuZXcgVGFibGVXYWxrZXIodGFibGUsIHsKICAgICAgICAgIHN0YXJ0Um93OiBuZXdSb3dzID8gbmV3Um93cyAtIDEgOiBuZXdSb3dzLAogICAgICAgICAgZW5kUm93OiBvbGRSb3dzIC0gMQogICAgICAgIH0pOwogICAgICAgIGNvbnN0IHRhYmxlQXR0cmlidXRlcyA9IHsKICAgICAgICAgIGhlYWRpbmdSb3dzOiB0YWJsZS5nZXRBdHRyaWJ1dGUoJ2hlYWRpbmdSb3dzJykgfHwgMCwKICAgICAgICAgIGhlYWRpbmdDb2x1bW5zOiB0YWJsZS5nZXRBdHRyaWJ1dGUoJ2hlYWRpbmdDb2x1bW5zJykgfHwgMAogICAgICAgIH07CgogICAgICAgIGZvciAoY29uc3QgdGFibGVXYWxrZXJWYWx1ZSBvZiB0YWJsZVdhbGtlcikgewogICAgICAgICAgcmVuYW1lVmlld1RhYmxlQ2VsbElmUmVxdWlyZWQodGFibGVXYWxrZXJWYWx1ZSwgdGFibGVBdHRyaWJ1dGVzLCBjb252ZXJzaW9uQXBpLCBhc1dpZGdldCk7CiAgICAgICAgfSAvLyBDbGVhbnVwOiB0aGlzIHdpbGwgcmVtb3ZlIGFueSBlbXB0eSBzZWN0aW9uIGZyb20gdGhlIHZpZXcgd2hpY2ggbWF5IGhhcHBlbiB3aGVuIG1vdmluZyBhbGwgcm93cyBmcm9tIGEgdGFibGUgc2VjdGlvbi4KCgogICAgICAgIHJlbW92ZVRhYmxlU2VjdGlvbklmRW1wdHkoJ3RoZWFkJywgdmlld1RhYmxlLCBjb252ZXJzaW9uQXBpKTsKICAgICAgfQoKICAgIGZ1bmN0aW9uIGlzQmV0d2VlbihpbmRleCwgbG93ZXIsIHVwcGVyKSB7CiAgICAgIHJldHVybiBpbmRleCA+IGxvd2VyICYmIGluZGV4IDwgdXBwZXI7CiAgICB9CiAgfSk7Cn0KLyoqCiAqIENvbnZlcnNpb24gaGVscGVyIHRoYXQgYWN0cyBvbiBoZWFkaW5nIGNvbHVtbnMgdGFibGUgYXR0cmlidXRlIGNoYW5nZS4KICoKICogRGVwZW5kaW5nIG9uIGNoYW5nZWQgYXR0cmlidXRlcyB0aGlzIGNvbnZlcnRlciB3aWxsIHJlbmFtZSBgPHRkYCB0byBgPHRoPmAgZWxlbWVudHMgb3IgdmljZSB2ZXJzYSBkZXBlbmRpbmcgb2YgdGhlIGNlbGwgY29sdW1uIGluZGV4LgogKgogKiBAcmV0dXJucyB7RnVuY3Rpb259IENvbnZlcnNpb24gaGVscGVyLgogKi8KCmV4cG9ydCBmdW5jdGlvbiBkb3duY2FzdFRhYmxlSGVhZGluZ0NvbHVtbnNDaGFuZ2Uob3B0aW9ucyA9IHt9KSB7CiAgY29uc3QgYXNXaWRnZXQgPSAhIW9wdGlvbnMuYXNXaWRnZXQ7CiAgcmV0dXJuIGRpc3BhdGNoZXIgPT4gZGlzcGF0Y2hlci5vbignYXR0cmlidXRlOmhlYWRpbmdDb2x1bW5zOnRhYmxlJywgKGV2dCwgZGF0YSwgY29udmVyc2lvbkFwaSkgPT4gewogICAgY29uc3QgdGFibGUgPSBkYXRhLml0ZW07CgogICAgaWYgKCFjb252ZXJzaW9uQXBpLmNvbnN1bWFibGUuY29uc3VtZShkYXRhLml0ZW0sIGV2dC5uYW1lKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgdGFibGVBdHRyaWJ1dGVzID0gewogICAgICBoZWFkaW5nUm93czogdGFibGUuZ2V0QXR0cmlidXRlKCdoZWFkaW5nUm93cycpIHx8IDAsCiAgICAgIGhlYWRpbmdDb2x1bW5zOiB0YWJsZS5nZXRBdHRyaWJ1dGUoJ2hlYWRpbmdDb2x1bW5zJykgfHwgMAogICAgfTsKICAgIGNvbnN0IG9sZENvbHVtbnMgPSBkYXRhLmF0dHJpYnV0ZU9sZFZhbHVlOwogICAgY29uc3QgbmV3Q29sdW1ucyA9IGRhdGEuYXR0cmlidXRlTmV3VmFsdWU7CiAgICBjb25zdCBsYXN0Q29sdW1uVG9DaGVjayA9IChvbGRDb2x1bW5zID4gbmV3Q29sdW1ucyA/IG9sZENvbHVtbnMgOiBuZXdDb2x1bW5zKSAtIDE7CgogICAgZm9yIChjb25zdCB0YWJsZVdhbGtlclZhbHVlIG9mIG5ldyBUYWJsZVdhbGtlcih0YWJsZSkpIHsKICAgICAgLy8gU2tpcCBjZWxscyB0aGF0IHdlcmUgbm90IGluIGhlYWRpbmcgc2VjdGlvbiBiZWZvcmUgYW5kIGFmdGVyIHRoZSBjaGFuZ2UuCiAgICAgIGlmICh0YWJsZVdhbGtlclZhbHVlLmNvbHVtbiA+IGxhc3RDb2x1bW5Ub0NoZWNrKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHJlbmFtZVZpZXdUYWJsZUNlbGxJZlJlcXVpcmVkKHRhYmxlV2Fsa2VyVmFsdWUsIHRhYmxlQXR0cmlidXRlcywgY29udmVyc2lvbkFwaSwgYXNXaWRnZXQpOwogICAgfQogIH0pOwp9Ci8qKgogKiBDb252ZXJzaW9uIGhlbHBlciB0aGF0IGFjdHMgb24gYSByZW1vdmVkIHJvdy4KICoKICogQHJldHVybnMge0Z1bmN0aW9ufSBDb252ZXJzaW9uIGhlbHBlci4KICovCgpleHBvcnQgZnVuY3Rpb24gZG93bmNhc3RSZW1vdmVSb3coKSB7CiAgcmV0dXJuIGRpc3BhdGNoZXIgPT4gZGlzcGF0Y2hlci5vbigncmVtb3ZlOnRhYmxlUm93JywgKGV2dCwgZGF0YSwgY29udmVyc2lvbkFwaSkgPT4gewogICAgLy8gUHJldmVudCBkZWZhdWx0IHJlbW92ZSBjb252ZXJ0ZXIuCiAgICBldnQuc3RvcCgpOwogICAgY29uc3Qgdmlld1dyaXRlciA9IGNvbnZlcnNpb25BcGkud3JpdGVyOwogICAgY29uc3QgbWFwcGVyID0gY29udmVyc2lvbkFwaS5tYXBwZXI7CiAgICBjb25zdCB2aWV3U3RhcnQgPSBtYXBwZXIudG9WaWV3UG9zaXRpb24oZGF0YS5wb3NpdGlvbikuZ2V0TGFzdE1hdGNoaW5nUG9zaXRpb24odmFsdWUgPT4gIXZhbHVlLml0ZW0uaXMoJ3RyJykpOwogICAgY29uc3Qgdmlld0l0ZW0gPSB2aWV3U3RhcnQubm9kZUFmdGVyOwogICAgY29uc3QgdGFibGVTZWN0aW9uID0gdmlld0l0ZW0ucGFyZW50OyAvLyBSZW1vdmUgYXNzb2NpYXRlZCA8dHI+IGZyb20gdGhlIHZpZXcuCgogICAgY29uc3QgcmVtb3ZlUmFuZ2UgPSB2aWV3V3JpdGVyLmNyZWF0ZVJhbmdlT24odmlld0l0ZW0pOwogICAgY29uc3QgcmVtb3ZlZCA9IHZpZXdXcml0ZXIucmVtb3ZlKHJlbW92ZVJhbmdlKTsKCiAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIHZpZXdXcml0ZXIuY3JlYXRlUmFuZ2VJbihyZW1vdmVkKS5nZXRJdGVtcygpKSB7CiAgICAgIG1hcHBlci51bmJpbmRWaWV3RWxlbWVudChjaGlsZCk7CiAgICB9IC8vIENoZWNrIGlmIHRhYmxlIHNlY3Rpb24gaGFzIGFueSBjaGlsZHJlbiBsZWZ0IC0gaWYgbm90IHJlbW92ZSBpdCBmcm9tIHRoZSB2aWV3LgoKCiAgICBpZiAoIXRhYmxlU2VjdGlvbi5jaGlsZENvdW50KSB7CiAgICAgIC8vIE5vIG5lZWQgdG8gdW5iaW5kIGFueXRoaW5nIGFzIHRhYmxlIHNlY3Rpb24gaXMgbm90IHJlcHJlc2VudGVkIGluIHRoZSBtb2RlbC4KICAgICAgdmlld1dyaXRlci5yZW1vdmUodmlld1dyaXRlci5jcmVhdGVSYW5nZU9uKHRhYmxlU2VjdGlvbikpOwogICAgfQogIH0sIHsKICAgIHByaW9yaXR5OiAnaGlnaGVyJwogIH0pOwp9IC8vIFJlbmFtZXMgYW4gZXhpc3RpbmcgdGFibGUgY2VsbCBpbiB0aGUgdmlldyB0byBhIGdpdmVuIGVsZW1lbnQgbmFtZS4KLy8KLy8gKipOb3RlKiogVGhpcyBtZXRob2Qgd2lsbCBub3QgZG8gYW55dGhpbmcgaWYgYSB2aWV3IHRhYmxlIGNlbGwgd2FzIG5vdCB5ZXQgY29udmVydGVkLgovLwovLyBAcGFyYW0ge21vZHVsZTplbmdpbmUvbW9kZWwvZWxlbWVudH5FbGVtZW50fSB0YWJsZUNlbGwKLy8gQHBhcmFtIHtTdHJpbmd9IGRlc2lyZWRDZWxsRWxlbWVudE5hbWUKLy8gQHBhcmFtIHttb2R1bGU6ZW5naW5lL2NvbnZlcnNpb24vZG93bmNhc3RkaXNwYXRjaGVyfkRvd25jYXN0Q29udmVyc2lvbkFwaX0gY29udmVyc2lvbkFwaQovLyBAcGFyYW0ge0Jvb2xlYW59IGFzV2lkZ2V0CgpmdW5jdGlvbiByZW5hbWVWaWV3VGFibGVDZWxsKHRhYmxlQ2VsbCwgZGVzaXJlZENlbGxFbGVtZW50TmFtZSwgY29udmVyc2lvbkFwaSwgYXNXaWRnZXQpIHsKICBjb25zdCB2aWV3V3JpdGVyID0gY29udmVyc2lvbkFwaS53cml0ZXI7CiAgY29uc3Qgdmlld0NlbGwgPSBjb252ZXJzaW9uQXBpLm1hcHBlci50b1ZpZXdFbGVtZW50KHRhYmxlQ2VsbCk7IC8vIFZpZXcgY2VsbCBtaWdodCBiZSBub3QgeWV0IGNvbnZlcnRlZCAtIHNraXAgaXQgYXMgaXQgd2lsbCBiZSBwcm9wZXJseSBjcmVhdGVkIGJ5IGNlbGwgY29udmVydGVyIGxhdGVyIG9uLgoKICBpZiAoIXZpZXdDZWxsKSB7CiAgICByZXR1cm47CiAgfQoKICBsZXQgcmVuYW1lZENlbGw7CgogIGlmIChhc1dpZGdldCkgewogICAgY29uc3QgZWRpdGFibGUgPSB2aWV3V3JpdGVyLmNyZWF0ZUVkaXRhYmxlRWxlbWVudChkZXNpcmVkQ2VsbEVsZW1lbnROYW1lLCB2aWV3Q2VsbC5nZXRBdHRyaWJ1dGVzKCkpOwogICAgcmVuYW1lZENlbGwgPSB0b1dpZGdldEVkaXRhYmxlKGVkaXRhYmxlLCB2aWV3V3JpdGVyKTsKICAgIHZpZXdXcml0ZXIuaW5zZXJ0KHZpZXdXcml0ZXIuY3JlYXRlUG9zaXRpb25BZnRlcih2aWV3Q2VsbCksIHJlbmFtZWRDZWxsKTsKICAgIHZpZXdXcml0ZXIubW92ZSh2aWV3V3JpdGVyLmNyZWF0ZVJhbmdlSW4odmlld0NlbGwpLCB2aWV3V3JpdGVyLmNyZWF0ZVBvc2l0aW9uQXQocmVuYW1lZENlbGwsIDApKTsKICAgIHZpZXdXcml0ZXIucmVtb3ZlKHZpZXdXcml0ZXIuY3JlYXRlUmFuZ2VPbih2aWV3Q2VsbCkpOwogIH0gZWxzZSB7CiAgICByZW5hbWVkQ2VsbCA9IHZpZXdXcml0ZXIucmVuYW1lKGRlc2lyZWRDZWxsRWxlbWVudE5hbWUsIHZpZXdDZWxsKTsKICB9CgogIGNvbnZlcnNpb25BcGkubWFwcGVyLnVuYmluZFZpZXdFbGVtZW50KHZpZXdDZWxsKTsKICBjb252ZXJzaW9uQXBpLm1hcHBlci5iaW5kRWxlbWVudHModGFibGVDZWxsLCByZW5hbWVkQ2VsbCk7Cn0gLy8gUmVuYW1lcyBhIHRhYmxlIGNlbGwgZWxlbWVudCBpbiB0aGUgdmlldyBhY2NvcmRpbmcgdG8gaXRzIGxvY2F0aW9uIGluIHRoZSB0YWJsZS4KLy8KLy8gQHBhcmFtIHttb2R1bGU6dGFibGUvdGFibGV3YWxrZXJ+VGFibGVXYWxrZXJWYWx1ZX0gdGFibGVXYWxrZXJWYWx1ZQovLyBAcGFyYW0ge3toZWFkaW5nQ29sdW1ucywgaGVhZGluZ1Jvd3N9fSB0YWJsZUF0dHJpYnV0ZXMKLy8gQHBhcmFtIHttb2R1bGU6ZW5naW5lL2NvbnZlcnNpb24vZG93bmNhc3RkaXNwYXRjaGVyfkRvd25jYXN0Q29udmVyc2lvbkFwaX0gY29udmVyc2lvbkFwaQovLyBAcGFyYW0ge0Jvb2xlYW59IGFzV2lkZ2V0CgoKZnVuY3Rpb24gcmVuYW1lVmlld1RhYmxlQ2VsbElmUmVxdWlyZWQodGFibGVXYWxrZXJWYWx1ZSwgdGFibGVBdHRyaWJ1dGVzLCBjb252ZXJzaW9uQXBpLCBhc1dpZGdldCkgewogIGNvbnN0IHsKICAgIGNlbGwKICB9ID0gdGFibGVXYWxrZXJWYWx1ZTsgLy8gQ2hlY2sgd2hldGhlciBjdXJyZW50IGNvbHVtbkluZGV4IGlzIG92ZXJsYXBwZWQgYnkgdGFibGUgY2VsbHMgZnJvbSBwcmV2aW91cyByb3dzLgoKICBjb25zdCBkZXNpcmVkQ2VsbEVsZW1lbnROYW1lID0gZ2V0Q2VsbEVsZW1lbnROYW1lKHRhYmxlV2Fsa2VyVmFsdWUsIHRhYmxlQXR0cmlidXRlcyk7CiAgY29uc3Qgdmlld0NlbGwgPSBjb252ZXJzaW9uQXBpLm1hcHBlci50b1ZpZXdFbGVtZW50KGNlbGwpOyAvLyBJZiBpbiBzaW5nbGUgY2hhbmdlIHdlJ3JlIGNvbnZlcnRpbmcgYXR0cmlidXRlIGNoYW5nZXMgYW5kIGluc2VydGluZyBjZWxsIHRoZSB0YWJsZSBjZWxsIG1pZ2h0IG5vdCBiZSBpbnNlcnRlZCBpbnRvIHZpZXcKICAvLyBiZWNhdXNlIG9mIGNoaWxkIGNvbnZlcnNpb24gaXMgZG9uZSBhZnRlciBwYXJlbnQuCgogIGlmICh2aWV3Q2VsbCAmJiB2aWV3Q2VsbC5uYW1lICE9PSBkZXNpcmVkQ2VsbEVsZW1lbnROYW1lKSB7CiAgICByZW5hbWVWaWV3VGFibGVDZWxsKGNlbGwsIGRlc2lyZWRDZWxsRWxlbWVudE5hbWUsIGNvbnZlcnNpb25BcGksIGFzV2lkZ2V0KTsKICB9Cn0gLy8gQ3JlYXRlcyBhIHRhYmxlIGNlbGwgZWxlbWVudCBpbiB0aGUgdmlldy4KLy8KLy8gQHBhcmFtIHttb2R1bGU6dGFibGUvdGFibGV3YWxrZXJ+VGFibGVXYWxrZXJWYWx1ZX0gdGFibGVXYWxrZXJWYWx1ZQovLyBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9wb3NpdGlvbn5Qb3NpdGlvbn0gaW5zZXJ0UG9zaXRpb24KLy8gQHBhcmFtIHttb2R1bGU6ZW5naW5lL2NvbnZlcnNpb24vZG93bmNhc3RkaXNwYXRjaGVyfkRvd25jYXN0Q29udmVyc2lvbkFwaX0gY29udmVyc2lvbkFwaQoKCmZ1bmN0aW9uIGNyZWF0ZVZpZXdUYWJsZUNlbGxFbGVtZW50KHRhYmxlV2Fsa2VyVmFsdWUsIHRhYmxlQXR0cmlidXRlcywgaW5zZXJ0UG9zaXRpb24sIGNvbnZlcnNpb25BcGksIG9wdGlvbnMpIHsKICBjb25zdCBhc1dpZGdldCA9IG9wdGlvbnMgJiYgb3B0aW9ucy5hc1dpZGdldDsKICBjb25zdCBjZWxsRWxlbWVudE5hbWUgPSBnZXRDZWxsRWxlbWVudE5hbWUodGFibGVXYWxrZXJWYWx1ZSwgdGFibGVBdHRyaWJ1dGVzKTsKICBjb25zdCBjZWxsRWxlbWVudCA9IGFzV2lkZ2V0ID8gdG9XaWRnZXRFZGl0YWJsZShjb252ZXJzaW9uQXBpLndyaXRlci5jcmVhdGVFZGl0YWJsZUVsZW1lbnQoY2VsbEVsZW1lbnROYW1lKSwgY29udmVyc2lvbkFwaS53cml0ZXIpIDogY29udmVyc2lvbkFwaS53cml0ZXIuY3JlYXRlQ29udGFpbmVyRWxlbWVudChjZWxsRWxlbWVudE5hbWUpOwogIGNvbnN0IHRhYmxlQ2VsbCA9IHRhYmxlV2Fsa2VyVmFsdWUuY2VsbDsKICBjb25zdCBmaXJzdENoaWxkID0gdGFibGVDZWxsLmdldENoaWxkKDApOwogIGNvbnN0IGlzU2luZ2xlUGFyYWdyYXBoID0gdGFibGVDZWxsLmNoaWxkQ291bnQgPT09IDEgJiYgZmlyc3RDaGlsZC5uYW1lID09PSAncGFyYWdyYXBoJzsKICBjb252ZXJzaW9uQXBpLndyaXRlci5pbnNlcnQoaW5zZXJ0UG9zaXRpb24sIGNlbGxFbGVtZW50KTsKCiAgaWYgKGlzU2luZ2xlUGFyYWdyYXBoICYmICFoYXNBbnlBdHRyaWJ1dGUoZmlyc3RDaGlsZCkpIHsKICAgIGNvbnN0IGlubmVyUGFyYWdyYXBoID0gdGFibGVDZWxsLmdldENoaWxkKDApOwogICAgY29uc3QgcGFyYWdyYXBoSW5zZXJ0UG9zaXRpb24gPSBjb252ZXJzaW9uQXBpLndyaXRlci5jcmVhdGVQb3NpdGlvbkF0KGNlbGxFbGVtZW50LCAnZW5kJyk7CiAgICBjb252ZXJzaW9uQXBpLmNvbnN1bWFibGUuY29uc3VtZShpbm5lclBhcmFncmFwaCwgJ2luc2VydCcpOwoKICAgIGlmIChvcHRpb25zLmFzV2lkZ2V0KSB7CiAgICAgIGNvbnN0IGZha2VQYXJhZ3JhcGggPSBjb252ZXJzaW9uQXBpLndyaXRlci5jcmVhdGVDb250YWluZXJFbGVtZW50KCdzcGFuJyk7CiAgICAgIGNvbnZlcnNpb25BcGkubWFwcGVyLmJpbmRFbGVtZW50cyhpbm5lclBhcmFncmFwaCwgZmFrZVBhcmFncmFwaCk7CiAgICAgIGNvbnZlcnNpb25BcGkud3JpdGVyLmluc2VydChwYXJhZ3JhcGhJbnNlcnRQb3NpdGlvbiwgZmFrZVBhcmFncmFwaCk7CiAgICAgIGNvbnZlcnNpb25BcGkubWFwcGVyLmJpbmRFbGVtZW50cyh0YWJsZUNlbGwsIGNlbGxFbGVtZW50KTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnZlcnNpb25BcGkubWFwcGVyLmJpbmRFbGVtZW50cyh0YWJsZUNlbGwsIGNlbGxFbGVtZW50KTsKICAgICAgY29udmVyc2lvbkFwaS5tYXBwZXIuYmluZEVsZW1lbnRzKGlubmVyUGFyYWdyYXBoLCBjZWxsRWxlbWVudCk7CiAgICB9CiAgfSBlbHNlIHsKICAgIGNvbnZlcnNpb25BcGkubWFwcGVyLmJpbmRFbGVtZW50cyh0YWJsZUNlbGwsIGNlbGxFbGVtZW50KTsKICB9Cn0gLy8gQ3JlYXRlcyBgPHRyPmAgdmlldyBlbGVtZW50LgovLwovLyBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9lbGVtZW50fkVsZW1lbnR9IHRhYmxlUm93Ci8vIEBwYXJhbSB7TnVtYmVyfSByb3dJbmRleAovLyBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9lbGVtZW50fkVsZW1lbnR9IHRhYmxlU2VjdGlvbgovLyBAcGFyYW0ge21vZHVsZTplbmdpbmUvY29udmVyc2lvbi9kb3duY2FzdGRpc3BhdGNoZXJ+RG93bmNhc3RDb252ZXJzaW9uQXBpfSBjb252ZXJzaW9uQXBpCi8vIEByZXR1cm5zIHttb2R1bGU6ZW5naW5lL3ZpZXcvZWxlbWVudH5FbGVtZW50fQoKCmZ1bmN0aW9uIGNyZWF0ZVRyKHRhYmxlUm93LCByb3dJbmRleCwgdGFibGVTZWN0aW9uLCBjb252ZXJzaW9uQXBpKSB7CiAgLy8gV2lsbCBhbHdheXMgY29uc3VtZSBzaW5jZSB3ZSdyZSBjb252ZXJ0aW5nIDx0YWJsZVJvdz4gZWxlbWVudCBmcm9tIGEgcGFyZW50IDx0YWJsZT4uCiAgY29udmVyc2lvbkFwaS5jb25zdW1hYmxlLmNvbnN1bWUodGFibGVSb3csICdpbnNlcnQnKTsKICBjb25zdCB0ckVsZW1lbnQgPSBjb252ZXJzaW9uQXBpLndyaXRlci5jcmVhdGVDb250YWluZXJFbGVtZW50KCd0cicpOwogIGNvbnZlcnNpb25BcGkubWFwcGVyLmJpbmRFbGVtZW50cyh0YWJsZVJvdywgdHJFbGVtZW50KTsKICBjb25zdCBoZWFkaW5nUm93cyA9IHRhYmxlUm93LnBhcmVudC5nZXRBdHRyaWJ1dGUoJ2hlYWRpbmdSb3dzJykgfHwgMDsKICBjb25zdCBvZmZzZXQgPSBoZWFkaW5nUm93cyA+IDAgJiYgcm93SW5kZXggPj0gaGVhZGluZ1Jvd3MgPyByb3dJbmRleCAtIGhlYWRpbmdSb3dzIDogcm93SW5kZXg7CiAgY29uc3QgcG9zaXRpb24gPSBjb252ZXJzaW9uQXBpLndyaXRlci5jcmVhdGVQb3NpdGlvbkF0KHRhYmxlU2VjdGlvbiwgb2Zmc2V0KTsKICBjb252ZXJzaW9uQXBpLndyaXRlci5pbnNlcnQocG9zaXRpb24sIHRyRWxlbWVudCk7CiAgcmV0dXJuIHRyRWxlbWVudDsKfSAvLyBSZXR1cm5zIGB0aGAgZm9yIGhlYWRpbmcgY2VsbHMgYW5kIGB0ZGAgZm9yIG90aGVyIGNlbGxzIGZvciB0aGUgY3VycmVudCB0YWJsZSB3YWxrZXIgdmFsdWUuCi8vCi8vIEBwYXJhbSB7bW9kdWxlOnRhYmxlL3RhYmxld2Fsa2VyflRhYmxlV2Fsa2VyVmFsdWV9IHRhYmxlV2Fsa2VyVmFsdWUKLy8gQHBhcmFtIHt7aGVhZGluZ0NvbHVtbnMsIGhlYWRpbmdSb3dzfX0gdGFibGVBdHRyaWJ1dGVzCi8vIEByZXR1cm5zIHtTdHJpbmd9CgoKZnVuY3Rpb24gZ2V0Q2VsbEVsZW1lbnROYW1lKHRhYmxlV2Fsa2VyVmFsdWUsIHRhYmxlQXR0cmlidXRlcykgewogIGNvbnN0IHsKICAgIHJvdywKICAgIGNvbHVtbgogIH0gPSB0YWJsZVdhbGtlclZhbHVlOwogIGNvbnN0IHsKICAgIGhlYWRpbmdDb2x1bW5zLAogICAgaGVhZGluZ1Jvd3MKICB9ID0gdGFibGVBdHRyaWJ1dGVzOyAvLyBDb2x1bW4gaGVhZGluZyBhcmUgYWxsIHRhYmxlQ2VsbHMgaW4gdGhlIGZpcnN0IGBjb2x1bW5IZWFkaW5nYCByb3dzLgoKICBjb25zdCBpc0NvbHVtbkhlYWRpbmcgPSBoZWFkaW5nUm93cyAmJiBoZWFkaW5nUm93cyA+IHJvdzsgLy8gU28gYSB3aG9sZSByb3cgZ2V0cyA8dGg+IGVsZW1lbnQuCgogIGlmIChpc0NvbHVtbkhlYWRpbmcpIHsKICAgIHJldHVybiAndGgnOwogIH0gLy8gUm93IGhlYWRpbmcgYXJlIHRhYmxlQ2VsbHMgd2hpY2ggY29sdW1uSW5kZXggaXMgbG93ZXIgdGhlbiBoZWFkaW5nQ29sdW1ucy4KCgogIGNvbnN0IGlzUm93SGVhZGluZyA9IGhlYWRpbmdDb2x1bW5zICYmIGhlYWRpbmdDb2x1bW5zID4gY29sdW1uOwogIHJldHVybiBpc1Jvd0hlYWRpbmcgPyAndGgnIDogJ3RkJzsKfSAvLyBSZXR1cm5zIHRoZSB0YWJsZSBzZWN0aW9uIG5hbWUgZm9yIHRoZSBjdXJyZW50IHRhYmxlIHdhbGtlciB2YWx1ZS4KLy8KLy8gQHBhcmFtIHtOdW1iZXJ9IHJvdwovLyBAcGFyYW0ge3toZWFkaW5nQ29sdW1ucywgaGVhZGluZ1Jvd3N9fSB0YWJsZUF0dHJpYnV0ZXMKLy8gQHJldHVybnMge1N0cmluZ30KCgpmdW5jdGlvbiBnZXRTZWN0aW9uTmFtZShyb3csIHRhYmxlQXR0cmlidXRlcykgewogIHJldHVybiByb3cgPCB0YWJsZUF0dHJpYnV0ZXMuaGVhZGluZ1Jvd3MgPyAndGhlYWQnIDogJ3Rib2R5JzsKfSAvLyBDcmVhdGVzIG9yIHJldHVybnMgYW4gZXhpc3RpbmcgYDx0Ym9keT5gIG9yIGA8dGhlYWQ+YCBlbGVtZW50IHdpdGNoIGNhY2hpbmcuCi8vCi8vIEBwYXJhbSB7U3RyaW5nfSBzZWN0aW9uTmFtZQovLyBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9lbGVtZW50fkVsZW1lbnR9IHZpZXdUYWJsZQovLyBAcGFyYW0ge21vZHVsZTplbmdpbmUvY29udmVyc2lvbi9kb3duY2FzdGRpc3BhdGNoZXJ+RG93bmNhc3RDb252ZXJzaW9uQXBpfSBjb252ZXJzaW9uQXBpCi8vIEBwYXJhbSB7T2JqZWN0fSBjYWNoZWRUYWJsZVNlY3Rpb24gQW4gb2JqZWN0IHRoYXQgc3RvcmVzIGNhY2hlZCBlbGVtZW50cy4KLy8gQHJldHVybnMge21vZHVsZTplbmdpbmUvdmlldy9jb250YWluZXJlbGVtZW50fkNvbnRhaW5lckVsZW1lbnR9CgoKZnVuY3Rpb24gZ2V0T3JDcmVhdGVUYWJsZVNlY3Rpb24oc2VjdGlvbk5hbWUsIHZpZXdUYWJsZSwgY29udmVyc2lvbkFwaSkgewogIGNvbnN0IHZpZXdUYWJsZVNlY3Rpb24gPSBnZXRFeGlzdGluZ1RhYmxlU2VjdGlvbkVsZW1lbnQoc2VjdGlvbk5hbWUsIHZpZXdUYWJsZSk7CiAgcmV0dXJuIHZpZXdUYWJsZVNlY3Rpb24gPyB2aWV3VGFibGVTZWN0aW9uIDogY3JlYXRlVGFibGVTZWN0aW9uKHNlY3Rpb25OYW1lLCB2aWV3VGFibGUsIGNvbnZlcnNpb25BcGkpOwp9IC8vIEZpbmRzIGFuIGV4aXN0aW5nIGA8dGJvZHk+YCBvciBgPHRoZWFkPmAgZWxlbWVudCBvciByZXR1cm5zIHVuZGVmaW5lZC4KLy8KLy8gQHBhcmFtIHtTdHJpbmd9IHNlY3Rpb25OYW1lCi8vIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS92aWV3L2VsZW1lbnR+RWxlbWVudH0gdGFibGVFbGVtZW50Ci8vIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS9jb252ZXJzaW9uL2Rvd25jYXN0ZGlzcGF0Y2hlcn5Eb3duY2FzdENvbnZlcnNpb25BcGl9IGNvbnZlcnNpb25BcGkKCgpmdW5jdGlvbiBnZXRFeGlzdGluZ1RhYmxlU2VjdGlvbkVsZW1lbnQoc2VjdGlvbk5hbWUsIHRhYmxlRWxlbWVudCkgewogIGZvciAoY29uc3QgdGFibGVTZWN0aW9uIG9mIHRhYmxlRWxlbWVudC5nZXRDaGlsZHJlbigpKSB7CiAgICBpZiAodGFibGVTZWN0aW9uLm5hbWUgPT0gc2VjdGlvbk5hbWUpIHsKICAgICAgcmV0dXJuIHRhYmxlU2VjdGlvbjsKICAgIH0KICB9Cn0gLy8gQ3JlYXRlcyBhIHRhYmxlIHNlY3Rpb24gYXQgdGhlIGVuZCBvZiB0aGUgdGFibGUuCi8vCi8vIEBwYXJhbSB7U3RyaW5nfSBzZWN0aW9uTmFtZQovLyBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9lbGVtZW50fkVsZW1lbnR9IHRhYmxlRWxlbWVudAovLyBAcGFyYW0ge21vZHVsZTplbmdpbmUvY29udmVyc2lvbi9kb3duY2FzdGRpc3BhdGNoZXJ+RG93bmNhc3RDb252ZXJzaW9uQXBpfSBjb252ZXJzaW9uQXBpCi8vIEByZXR1cm5zIHttb2R1bGU6ZW5naW5lL3ZpZXcvY29udGFpbmVyZWxlbWVudH5Db250YWluZXJFbGVtZW50fQoKCmZ1bmN0aW9uIGNyZWF0ZVRhYmxlU2VjdGlvbihzZWN0aW9uTmFtZSwgdGFibGVFbGVtZW50LCBjb252ZXJzaW9uQXBpKSB7CiAgY29uc3QgdGFibGVDaGlsZEVsZW1lbnQgPSBjb252ZXJzaW9uQXBpLndyaXRlci5jcmVhdGVDb250YWluZXJFbGVtZW50KHNlY3Rpb25OYW1lKTsKICBjb25zdCBpbnNlcnRQb3NpdGlvbiA9IGNvbnZlcnNpb25BcGkud3JpdGVyLmNyZWF0ZVBvc2l0aW9uQXQodGFibGVFbGVtZW50LCBzZWN0aW9uTmFtZSA9PSAndGJvZHknID8gJ2VuZCcgOiAwKTsKICBjb252ZXJzaW9uQXBpLndyaXRlci5pbnNlcnQoaW5zZXJ0UG9zaXRpb24sIHRhYmxlQ2hpbGRFbGVtZW50KTsKICByZXR1cm4gdGFibGVDaGlsZEVsZW1lbnQ7Cn0gLy8gUmVtb3ZlcyBhbiBleGlzdGluZyBgPHRib2R5PmAgb3IgYDx0aGVhZD5gIGVsZW1lbnQgaWYgaXQgaXMgZW1wdHkuCi8vCi8vIEBwYXJhbSB7U3RyaW5nfSBzZWN0aW9uTmFtZQovLyBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9lbGVtZW50fkVsZW1lbnR9IHRhYmxlRWxlbWVudAovLyBAcGFyYW0ge21vZHVsZTplbmdpbmUvY29udmVyc2lvbi9kb3duY2FzdGRpc3BhdGNoZXJ+RG93bmNhc3RDb252ZXJzaW9uQXBpfSBjb252ZXJzaW9uQXBpCgoKZnVuY3Rpb24gcmVtb3ZlVGFibGVTZWN0aW9uSWZFbXB0eShzZWN0aW9uTmFtZSwgdGFibGVFbGVtZW50LCBjb252ZXJzaW9uQXBpKSB7CiAgY29uc3QgdGFibGVTZWN0aW9uID0gZ2V0RXhpc3RpbmdUYWJsZVNlY3Rpb25FbGVtZW50KHNlY3Rpb25OYW1lLCB0YWJsZUVsZW1lbnQpOwoKICBpZiAodGFibGVTZWN0aW9uICYmIHRhYmxlU2VjdGlvbi5jaGlsZENvdW50ID09PSAwKSB7CiAgICBjb252ZXJzaW9uQXBpLndyaXRlci5yZW1vdmUoY29udmVyc2lvbkFwaS53cml0ZXIuY3JlYXRlUmFuZ2VPbih0YWJsZVNlY3Rpb24pKTsKICB9Cn0gLy8gTW92ZXMgdmlldyB0YWJsZSByb3dzIGFzc29jaWF0ZWQgd2l0aCBwYXNzZWQgbW9kZWwgcm93cyB0byB0aGUgcHJvdmlkZWQgdGFibGUgc2VjdGlvbiBlbGVtZW50LgovLwovLyAqKk5vdGUqKiBUaGlzIG1ldGhvZCB3aWxsIHNraXAgbm90IGNvbnZlcnRlZCB0YWJsZSByb3dzLgovLwovLyBAcGFyYW0ge0FycmF5Ljxtb2R1bGU6ZW5naW5lL21vZGVsL2VsZW1lbnR+RWxlbWVudD59IHJvd3NUb01vdmUKLy8gQHBhcmFtIHttb2R1bGU6ZW5naW5lL3ZpZXcvZWxlbWVudH5FbGVtZW50fSB2aWV3VGFibGVTZWN0aW9uCi8vIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS9jb252ZXJzaW9uL2Rvd25jYXN0ZGlzcGF0Y2hlcn5Eb3duY2FzdENvbnZlcnNpb25BcGl9IGNvbnZlcnNpb25BcGkKLy8gQHBhcmFtIHtOdW1iZXJ8J2VuZCd8J2JlZm9yZSd8J2FmdGVyJ30gb2Zmc2V0IE9mZnNldCBvciBvbmUgb2YgdGhlIGZsYWdzLgoKCmZ1bmN0aW9uIG1vdmVWaWV3Um93c1RvVGFibGVTZWN0aW9uKHJvd3NUb01vdmUsIHZpZXdUYWJsZVNlY3Rpb24sIGNvbnZlcnNpb25BcGksIG9mZnNldCkgewogIGZvciAoY29uc3QgdGFibGVSb3cgb2Ygcm93c1RvTW92ZSkgewogICAgY29uc3Qgdmlld1RhYmxlUm93ID0gY29udmVyc2lvbkFwaS5tYXBwZXIudG9WaWV3RWxlbWVudCh0YWJsZVJvdyk7IC8vIFZpZXcgdGFibGUgcm93IG1pZ2h0IGJlIG5vdCB5ZXQgY29udmVydGVkIC0gc2tpcCBpdCBhcyBpdCB3aWxsIGJlIHByb3Blcmx5IGNyZWF0ZWQgYnkgY2VsbCBjb252ZXJ0ZXIgbGF0ZXIgb24uCgogICAgaWYgKHZpZXdUYWJsZVJvdykgewogICAgICBjb252ZXJzaW9uQXBpLndyaXRlci5tb3ZlKGNvbnZlcnNpb25BcGkud3JpdGVyLmNyZWF0ZVJhbmdlT24odmlld1RhYmxlUm93KSwgY29udmVyc2lvbkFwaS53cml0ZXIuY3JlYXRlUG9zaXRpb25BdCh2aWV3VGFibGVTZWN0aW9uLCBvZmZzZXQpKTsKICAgIH0KICB9Cn0gLy8gUHJvcGVybHkgZmluZHMgJzx0YWJsZT4nIGVsZW1lbnQgaW5zaWRlIGA8ZmlndXJlPmAgd2lkZ2V0LgovLwovLyBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9lbGVtZW50fkVsZW1lbnR9IHZpZXdGaWd1cmUKCgpmdW5jdGlvbiBnZXRWaWV3VGFibGUodmlld0ZpZ3VyZSkgewogIGZvciAoY29uc3QgY2hpbGQgb2Ygdmlld0ZpZ3VyZS5nZXRDaGlsZHJlbigpKSB7CiAgICBpZiAoY2hpbGQubmFtZSA9PT0gJ3RhYmxlJykgewogICAgICByZXR1cm4gY2hpbGQ7CiAgICB9CiAgfQp9IC8vIENoZWNrcyBpZiBlbGVtZW50IGhhcyBhbnkgYXR0cmlidXRlIHNldC4KLy8KLy8gQHBhcmFtIHttb2R1bGU6ZW5naW5lL21vZGVsL2VsZW1lbnR+RWxlbWVudCBlbGVtZW50Ci8vIEByZXR1cm5zIHtCb29sZWFufQoKCmZ1bmN0aW9uIGhhc0FueUF0dHJpYnV0ZShlbGVtZW50KSB7CiAgcmV0dXJuICEhWy4uLmVsZW1lbnQuZ2V0QXR0cmlidXRlS2V5cygpXS5sZW5ndGg7Cn0="},{"version":3,"sources":["/Users/antonyching/Desktop/project/new-builder-demo/node_modules/@ckeditor/ckeditor5-table/src/converters/downcast.js"],"names":["TableWalker","toWidgetEditable","toTableWidget","downcastInsertTable","options","dispatcher","on","evt","data","conversionApi","table","item","consumable","consume","asWidget","figureElement","writer","createContainerElement","class","tableElement","insert","createPositionAt","tableWidget","tableWalker","tableAttributes","headingRows","getAttribute","headingColumns","viewRows","Map","tableWalkerValue","row","cell","tableSection","getOrCreateTableSection","getSectionName","tableRow","getChild","trElement","get","createTr","set","insertPosition","createViewTableCellElement","viewPosition","mapper","toViewPosition","range","start","bindElements","downcastInsertRow","parent","toViewElement","getViewTable","getChildIndex","startRow","endRow","downcastInsertCell","tableCell","rowIndex","downcastTableHeadingRowsChange","name","viewTable","oldRows","attributeOldValue","newRows","attributeNewValue","rowsToMove","Array","from","getChildren","filter","index","isBetween","viewTableHead","moveViewRowsToTableSection","renameViewTableCell","removeTableSectionIfEmpty","reverse","viewTableBody","renameViewTableCellIfRequired","lower","upper","downcastTableHeadingColumnsChange","oldColumns","newColumns","lastColumnToCheck","column","downcastRemoveRow","stop","viewWriter","viewStart","position","getLastMatchingPosition","value","is","viewItem","nodeAfter","removeRange","createRangeOn","removed","remove","child","createRangeIn","getItems","unbindViewElement","childCount","priority","desiredCellElementName","viewCell","renamedCell","editable","createEditableElement","getAttributes","createPositionAfter","move","rename","getCellElementName","cellElementName","cellElement","firstChild","isSingleParagraph","hasAnyAttribute","innerParagraph","paragraphInsertPosition","fakeParagraph","offset","isColumnHeading","isRowHeading","sectionName","viewTableSection","getExistingTableSectionElement","createTableSection","tableChildElement","viewTableRow","viewFigure","element","getAttributeKeys","length"],"mappings":"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","sourcesContent":["/**\n * @license Copyright (c) 2003-2019, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\n/**\n * @module table/converters/downcast\n */\n\nimport TableWalker from './../tablewalker';\nimport { toWidgetEditable } from '@ckeditor/ckeditor5-widget/src/utils';\nimport { toTableWidget } from '../utils';\n\n/**\n * Model table element to view table element conversion helper.\n *\n * This conversion helper creates the whole table element with child elements.\n *\n * @param {Object} options\n * @param {Boolean} options.asWidget If set to `true`, the downcast conversion will produce a widget.\n * @returns {Function} Conversion helper.\n */\nexport function downcastInsertTable( options = {} ) {\n\treturn dispatcher => dispatcher.on( 'insert:table', ( evt, data, conversionApi ) => {\n\t\tconst table = data.item;\n\n\t\tif ( !conversionApi.consumable.consume( table, 'insert' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Consume attributes if present to not fire attribute change downcast\n\t\tconversionApi.consumable.consume( table, 'attribute:headingRows:table' );\n\t\tconversionApi.consumable.consume( table, 'attribute:headingColumns:table' );\n\n\t\tconst asWidget = options && options.asWidget;\n\n\t\tconst figureElement = conversionApi.writer.createContainerElement( 'figure', { class: 'table' } );\n\t\tconst tableElement = conversionApi.writer.createContainerElement( 'table' );\n\t\tconversionApi.writer.insert( conversionApi.writer.createPositionAt( figureElement, 0 ), tableElement );\n\n\t\tlet tableWidget;\n\n\t\tif ( asWidget ) {\n\t\t\ttableWidget = toTableWidget( figureElement, conversionApi.writer );\n\t\t}\n\n\t\tconst tableWalker = new TableWalker( table );\n\n\t\tconst tableAttributes = {\n\t\t\theadingRows: table.getAttribute( 'headingRows' ) || 0,\n\t\t\theadingColumns: table.getAttribute( 'headingColumns' ) || 0\n\t\t};\n\n\t\t// Cache for created table rows.\n\t\tconst viewRows = new Map();\n\n\t\tfor ( const tableWalkerValue of tableWalker ) {\n\t\t\tconst { row, cell } = tableWalkerValue;\n\n\t\t\tconst tableSection = getOrCreateTableSection( getSectionName( row, tableAttributes ), tableElement, conversionApi );\n\t\t\tconst tableRow = table.getChild( row );\n\n\t\t\tconst trElement = viewRows.get( row ) || createTr( tableRow, row, tableSection, conversionApi );\n\t\t\tviewRows.set( row, trElement );\n\n\t\t\t// Consume table cell - it will be always consumed as we convert whole table at once.\n\t\t\tconversionApi.consumable.consume( cell, 'insert' );\n\n\t\t\tconst insertPosition = conversionApi.writer.createPositionAt( trElement, 'end' );\n\n\t\t\tcreateViewTableCellElement( tableWalkerValue, tableAttributes, insertPosition, conversionApi, options );\n\t\t}\n\n\t\tconst viewPosition = conversionApi.mapper.toViewPosition( data.range.start );\n\n\t\tconversionApi.mapper.bindElements( table, asWidget ? tableWidget : figureElement );\n\t\tconversionApi.writer.insert( viewPosition, asWidget ? tableWidget : figureElement );\n\t} );\n}\n\n/**\n * Model row element to view `<tr>` element conversion helper.\n *\n * This conversion helper creates the whole `<tr>` element with child elements.\n *\n * @returns {Function} Conversion helper.\n */\nexport function downcastInsertRow( options = {} ) {\n\treturn dispatcher => dispatcher.on( 'insert:tableRow', ( evt, data, conversionApi ) => {\n\t\tconst tableRow = data.item;\n\n\t\tif ( !conversionApi.consumable.consume( tableRow, 'insert' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst table = tableRow.parent;\n\n\t\tconst figureElement = conversionApi.mapper.toViewElement( table );\n\t\tconst tableElement = getViewTable( figureElement );\n\n\t\tconst row = table.getChildIndex( tableRow );\n\n\t\tconst tableWalker = new TableWalker( table, { startRow: row, endRow: row } );\n\n\t\tconst tableAttributes = {\n\t\t\theadingRows: table.getAttribute( 'headingRows' ) || 0,\n\t\t\theadingColumns: table.getAttribute( 'headingColumns' ) || 0\n\t\t};\n\n\t\t// Cache for created table rows.\n\t\tconst viewRows = new Map();\n\n\t\tfor ( const tableWalkerValue of tableWalker ) {\n\t\t\tconst tableSection = getOrCreateTableSection( getSectionName( row, tableAttributes ), tableElement, conversionApi );\n\n\t\t\tconst trElement = viewRows.get( row ) || createTr( tableRow, row, tableSection, conversionApi );\n\t\t\tviewRows.set( row, trElement );\n\n\t\t\t// Consume table cell - it will be always consumed as we convert whole row at once.\n\t\t\tconversionApi.consumable.consume( tableWalkerValue.cell, 'insert' );\n\n\t\t\tconst insertPosition = conversionApi.writer.createPositionAt( trElement, 'end' );\n\n\t\t\tcreateViewTableCellElement( tableWalkerValue, tableAttributes, insertPosition, conversionApi, options );\n\t\t}\n\t} );\n}\n\n/**\n * Model table cell element to view `<td>` or `<th>` element conversion helper.\n *\n * This conversion helper will create proper `<th>` elements for table cells that are in the heading section (heading row or column)\n * and `<td>` otherwise.\n *\n * @returns {Function} Conversion helper.\n */\nexport function downcastInsertCell( options = {} ) {\n\treturn dispatcher => dispatcher.on( 'insert:tableCell', ( evt, data, conversionApi ) => {\n\t\tconst tableCell = data.item;\n\n\t\tif ( !conversionApi.consumable.consume( tableCell, 'insert' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst tableRow = tableCell.parent;\n\t\tconst table = tableRow.parent;\n\t\tconst rowIndex = table.getChildIndex( tableRow );\n\n\t\tconst tableWalker = new TableWalker( table, { startRow: rowIndex, endRow: rowIndex } );\n\n\t\tconst tableAttributes = {\n\t\t\theadingRows: table.getAttribute( 'headingRows' ) || 0,\n\t\t\theadingColumns: table.getAttribute( 'headingColumns' ) || 0\n\t\t};\n\n\t\t// We need to iterate over a table in order to get proper row & column values from a walker\n\t\tfor ( const tableWalkerValue of tableWalker ) {\n\t\t\tif ( tableWalkerValue.cell === tableCell ) {\n\t\t\t\tconst trElement = conversionApi.mapper.toViewElement( tableRow );\n\t\t\t\tconst insertPosition = conversionApi.writer.createPositionAt( trElement, tableRow.getChildIndex( tableCell ) );\n\n\t\t\t\tcreateViewTableCellElement( tableWalkerValue, tableAttributes, insertPosition, conversionApi, options );\n\n\t\t\t\t// No need to iterate further.\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t} );\n}\n\n/**\n * Conversion helper that acts on heading rows table attribute change.\n *\n * This converter will:\n *\n * * Rename `<td>` to `<th>` elements or vice versa depending on headings.\n * * Create `<thead>` or `<tbody>` elements if needed.\n * * Remove empty `<thead>` or `<tbody>` if needed.\n *\n * @returns {Function} Conversion helper.\n */\nexport function downcastTableHeadingRowsChange( options = {} ) {\n\tconst asWidget = !!options.asWidget;\n\n\treturn dispatcher => dispatcher.on( 'attribute:headingRows:table', ( evt, data, conversionApi ) => {\n\t\tconst table = data.item;\n\n\t\tif ( !conversionApi.consumable.consume( data.item, evt.name ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst figureElement = conversionApi.mapper.toViewElement( table );\n\t\tconst viewTable = getViewTable( figureElement );\n\n\t\tconst oldRows = data.attributeOldValue;\n\t\tconst newRows = data.attributeNewValue;\n\n\t\t// The head section has grown so move rows from <tbody> to <thead>.\n\t\tif ( newRows > oldRows ) {\n\t\t\t// Filter out only those rows that are in wrong section.\n\t\t\tconst rowsToMove = Array.from( table.getChildren() ).filter( ( { index } ) => isBetween( index, oldRows - 1, newRows ) );\n\n\t\t\tconst viewTableHead = getOrCreateTableSection( 'thead', viewTable, conversionApi );\n\t\t\tmoveViewRowsToTableSection( rowsToMove, viewTableHead, conversionApi, 'end' );\n\n\t\t\t// Rename all table cells from moved rows to 'th' as they lands in <thead>.\n\t\t\tfor ( const tableRow of rowsToMove ) {\n\t\t\t\tfor ( const tableCell of tableRow.getChildren() ) {\n\t\t\t\t\trenameViewTableCell( tableCell, 'th', conversionApi, asWidget );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Cleanup: this will remove any empty section from the view which may happen when moving all rows from a table section.\n\t\t\tremoveTableSectionIfEmpty( 'tbody', viewTable, conversionApi );\n\t\t}\n\t\t// The head section has shrunk so move rows from <thead> to <tbody>.\n\t\telse {\n\t\t\t// Filter out only those rows that are in wrong section.\n\t\t\tconst rowsToMove = Array.from( table.getChildren() )\n\t\t\t\t.filter( ( { index } ) => isBetween( index, newRows - 1, oldRows ) )\n\t\t\t\t.reverse(); // The rows will be moved from <thead> to <tbody> in reverse order at the beginning of a <tbody>.\n\n\t\t\tconst viewTableBody = getOrCreateTableSection( 'tbody', viewTable, conversionApi );\n\t\t\tmoveViewRowsToTableSection( rowsToMove, viewTableBody, conversionApi, 0 );\n\n\t\t\t// Check if cells moved from <thead> to <tbody> requires renaming to <td> as this depends on current heading columns attribute.\n\t\t\tconst tableWalker = new TableWalker( table, { startRow: newRows ? newRows - 1 : newRows, endRow: oldRows - 1 } );\n\n\t\t\tconst tableAttributes = {\n\t\t\t\theadingRows: table.getAttribute( 'headingRows' ) || 0,\n\t\t\t\theadingColumns: table.getAttribute( 'headingColumns' ) || 0\n\t\t\t};\n\n\t\t\tfor ( const tableWalkerValue of tableWalker ) {\n\t\t\t\trenameViewTableCellIfRequired( tableWalkerValue, tableAttributes, conversionApi, asWidget );\n\t\t\t}\n\n\t\t\t// Cleanup: this will remove any empty section from the view which may happen when moving all rows from a table section.\n\t\t\tremoveTableSectionIfEmpty( 'thead', viewTable, conversionApi );\n\t\t}\n\n\t\tfunction isBetween( index, lower, upper ) {\n\t\t\treturn index > lower && index < upper;\n\t\t}\n\t} );\n}\n\n/**\n * Conversion helper that acts on heading columns table attribute change.\n *\n * Depending on changed attributes this converter will rename `<td` to `<th>` elements or vice versa depending of the cell column index.\n *\n * @returns {Function} Conversion helper.\n */\nexport function downcastTableHeadingColumnsChange( options = {} ) {\n\tconst asWidget = !!options.asWidget;\n\n\treturn dispatcher => dispatcher.on( 'attribute:headingColumns:table', ( evt, data, conversionApi ) => {\n\t\tconst table = data.item;\n\n\t\tif ( !conversionApi.consumable.consume( data.item, evt.name ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst tableAttributes = {\n\t\t\theadingRows: table.getAttribute( 'headingRows' ) || 0,\n\t\t\theadingColumns: table.getAttribute( 'headingColumns' ) || 0\n\t\t};\n\n\t\tconst oldColumns = data.attributeOldValue;\n\t\tconst newColumns = data.attributeNewValue;\n\n\t\tconst lastColumnToCheck = ( oldColumns > newColumns ? oldColumns : newColumns ) - 1;\n\n\t\tfor ( const tableWalkerValue of new TableWalker( table ) ) {\n\t\t\t// Skip cells that were not in heading section before and after the change.\n\t\t\tif ( tableWalkerValue.column > lastColumnToCheck ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\trenameViewTableCellIfRequired( tableWalkerValue, tableAttributes, conversionApi, asWidget );\n\t\t}\n\t} );\n}\n\n/**\n * Conversion helper that acts on a removed row.\n *\n * @returns {Function} Conversion helper.\n */\nexport function downcastRemoveRow() {\n\treturn dispatcher => dispatcher.on( 'remove:tableRow', ( evt, data, conversionApi ) => {\n\t\t// Prevent default remove converter.\n\t\tevt.stop();\n\t\tconst viewWriter = conversionApi.writer;\n\t\tconst mapper = conversionApi.mapper;\n\n\t\tconst viewStart = mapper.toViewPosition( data.position ).getLastMatchingPosition( value => !value.item.is( 'tr' ) );\n\t\tconst viewItem = viewStart.nodeAfter;\n\t\tconst tableSection = viewItem.parent;\n\n\t\t// Remove associated <tr> from the view.\n\t\tconst removeRange = viewWriter.createRangeOn( viewItem );\n\t\tconst removed = viewWriter.remove( removeRange );\n\n\t\tfor ( const child of viewWriter.createRangeIn( removed ).getItems() ) {\n\t\t\tmapper.unbindViewElement( child );\n\t\t}\n\n\t\t// Check if table section has any children left - if not remove it from the view.\n\t\tif ( !tableSection.childCount ) {\n\t\t\t// No need to unbind anything as table section is not represented in the model.\n\t\t\tviewWriter.remove( viewWriter.createRangeOn( tableSection ) );\n\t\t}\n\t}, { priority: 'higher' } );\n}\n\n// Renames an existing table cell in the view to a given element name.\n//\n// **Note** This method will not do anything if a view table cell was not yet converted.\n//\n// @param {module:engine/model/element~Element} tableCell\n// @param {String} desiredCellElementName\n// @param {module:engine/conversion/downcastdispatcher~DowncastConversionApi} conversionApi\n// @param {Boolean} asWidget\nfunction renameViewTableCell( tableCell, desiredCellElementName, conversionApi, asWidget ) {\n\tconst viewWriter = conversionApi.writer;\n\tconst viewCell = conversionApi.mapper.toViewElement( tableCell );\n\n\t// View cell might be not yet converted - skip it as it will be properly created by cell converter later on.\n\tif ( !viewCell ) {\n\t\treturn;\n\t}\n\n\tlet renamedCell;\n\n\tif ( asWidget ) {\n\t\tconst editable = viewWriter.createEditableElement( desiredCellElementName, viewCell.getAttributes() );\n\t\trenamedCell = toWidgetEditable( editable, viewWriter );\n\n\t\tviewWriter.insert( viewWriter.createPositionAfter( viewCell ), renamedCell );\n\t\tviewWriter.move( viewWriter.createRangeIn( viewCell ), viewWriter.createPositionAt( renamedCell, 0 ) );\n\t\tviewWriter.remove( viewWriter.createRangeOn( viewCell ) );\n\t} else {\n\t\trenamedCell = viewWriter.rename( desiredCellElementName, viewCell );\n\t}\n\n\tconversionApi.mapper.unbindViewElement( viewCell );\n\tconversionApi.mapper.bindElements( tableCell, renamedCell );\n}\n\n// Renames a table cell element in the view according to its location in the table.\n//\n// @param {module:table/tablewalker~TableWalkerValue} tableWalkerValue\n// @param {{headingColumns, headingRows}} tableAttributes\n// @param {module:engine/conversion/downcastdispatcher~DowncastConversionApi} conversionApi\n// @param {Boolean} asWidget\nfunction renameViewTableCellIfRequired( tableWalkerValue, tableAttributes, conversionApi, asWidget ) {\n\tconst { cell } = tableWalkerValue;\n\n\t// Check whether current columnIndex is overlapped by table cells from previous rows.\n\tconst desiredCellElementName = getCellElementName( tableWalkerValue, tableAttributes );\n\n\tconst viewCell = conversionApi.mapper.toViewElement( cell );\n\n\t// If in single change we're converting attribute changes and inserting cell the table cell might not be inserted into view\n\t// because of child conversion is done after parent.\n\tif ( viewCell && viewCell.name !== desiredCellElementName ) {\n\t\trenameViewTableCell( cell, desiredCellElementName, conversionApi, asWidget );\n\t}\n}\n\n// Creates a table cell element in the view.\n//\n// @param {module:table/tablewalker~TableWalkerValue} tableWalkerValue\n// @param {module:engine/view/position~Position} insertPosition\n// @param {module:engine/conversion/downcastdispatcher~DowncastConversionApi} conversionApi\nfunction createViewTableCellElement( tableWalkerValue, tableAttributes, insertPosition, conversionApi, options ) {\n\tconst asWidget = options && options.asWidget;\n\tconst cellElementName = getCellElementName( tableWalkerValue, tableAttributes );\n\n\tconst cellElement = asWidget ?\n\t\ttoWidgetEditable( conversionApi.writer.createEditableElement( cellElementName ), conversionApi.writer ) :\n\t\tconversionApi.writer.createContainerElement( cellElementName );\n\n\tconst tableCell = tableWalkerValue.cell;\n\n\tconst firstChild = tableCell.getChild( 0 );\n\tconst isSingleParagraph = tableCell.childCount === 1 && firstChild.name === 'paragraph';\n\n\tconversionApi.writer.insert( insertPosition, cellElement );\n\n\tif ( isSingleParagraph && !hasAnyAttribute( firstChild ) ) {\n\t\tconst innerParagraph = tableCell.getChild( 0 );\n\t\tconst paragraphInsertPosition = conversionApi.writer.createPositionAt( cellElement, 'end' );\n\n\t\tconversionApi.consumable.consume( innerParagraph, 'insert' );\n\n\t\tif ( options.asWidget ) {\n\t\t\tconst fakeParagraph = conversionApi.writer.createContainerElement( 'span' );\n\n\t\t\tconversionApi.mapper.bindElements( innerParagraph, fakeParagraph );\n\t\t\tconversionApi.writer.insert( paragraphInsertPosition, fakeParagraph );\n\n\t\t\tconversionApi.mapper.bindElements( tableCell, cellElement );\n\t\t} else {\n\t\t\tconversionApi.mapper.bindElements( tableCell, cellElement );\n\t\t\tconversionApi.mapper.bindElements( innerParagraph, cellElement );\n\t\t}\n\t} else {\n\t\tconversionApi.mapper.bindElements( tableCell, cellElement );\n\t}\n}\n\n// Creates `<tr>` view element.\n//\n// @param {module:engine/view/element~Element} tableRow\n// @param {Number} rowIndex\n// @param {module:engine/view/element~Element} tableSection\n// @param {module:engine/conversion/downcastdispatcher~DowncastConversionApi} conversionApi\n// @returns {module:engine/view/element~Element}\nfunction createTr( tableRow, rowIndex, tableSection, conversionApi ) {\n\t// Will always consume since we're converting <tableRow> element from a parent <table>.\n\tconversionApi.consumable.consume( tableRow, 'insert' );\n\n\tconst trElement = conversionApi.writer.createContainerElement( 'tr' );\n\tconversionApi.mapper.bindElements( tableRow, trElement );\n\n\tconst headingRows = tableRow.parent.getAttribute( 'headingRows' ) || 0;\n\tconst offset = headingRows > 0 && rowIndex >= headingRows ? rowIndex - headingRows : rowIndex;\n\n\tconst position = conversionApi.writer.createPositionAt( tableSection, offset );\n\tconversionApi.writer.insert( position, trElement );\n\n\treturn trElement;\n}\n\n// Returns `th` for heading cells and `td` for other cells for the current table walker value.\n//\n// @param {module:table/tablewalker~TableWalkerValue} tableWalkerValue\n// @param {{headingColumns, headingRows}} tableAttributes\n// @returns {String}\nfunction getCellElementName( tableWalkerValue, tableAttributes ) {\n\tconst { row, column } = tableWalkerValue;\n\tconst { headingColumns, headingRows } = tableAttributes;\n\n\t// Column heading are all tableCells in the first `columnHeading` rows.\n\tconst isColumnHeading = headingRows && headingRows > row;\n\n\t// So a whole row gets <th> element.\n\tif ( isColumnHeading ) {\n\t\treturn 'th';\n\t}\n\n\t// Row heading are tableCells which columnIndex is lower then headingColumns.\n\tconst isRowHeading = headingColumns && headingColumns > column;\n\n\treturn isRowHeading ? 'th' : 'td';\n}\n\n// Returns the table section name for the current table walker value.\n//\n// @param {Number} row\n// @param {{headingColumns, headingRows}} tableAttributes\n// @returns {String}\nfunction getSectionName( row, tableAttributes ) {\n\treturn row < tableAttributes.headingRows ? 'thead' : 'tbody';\n}\n\n// Creates or returns an existing `<tbody>` or `<thead>` element witch caching.\n//\n// @param {String} sectionName\n// @param {module:engine/view/element~Element} viewTable\n// @param {module:engine/conversion/downcastdispatcher~DowncastConversionApi} conversionApi\n// @param {Object} cachedTableSection An object that stores cached elements.\n// @returns {module:engine/view/containerelement~ContainerElement}\nfunction getOrCreateTableSection( sectionName, viewTable, conversionApi ) {\n\tconst viewTableSection = getExistingTableSectionElement( sectionName, viewTable );\n\n\treturn viewTableSection ? viewTableSection : createTableSection( sectionName, viewTable, conversionApi );\n}\n\n// Finds an existing `<tbody>` or `<thead>` element or returns undefined.\n//\n// @param {String} sectionName\n// @param {module:engine/view/element~Element} tableElement\n// @param {module:engine/conversion/downcastdispatcher~DowncastConversionApi} conversionApi\nfunction getExistingTableSectionElement( sectionName, tableElement ) {\n\tfor ( const tableSection of tableElement.getChildren() ) {\n\t\tif ( tableSection.name == sectionName ) {\n\t\t\treturn tableSection;\n\t\t}\n\t}\n}\n\n// Creates a table section at the end of the table.\n//\n// @param {String} sectionName\n// @param {module:engine/view/element~Element} tableElement\n// @param {module:engine/conversion/downcastdispatcher~DowncastConversionApi} conversionApi\n// @returns {module:engine/view/containerelement~ContainerElement}\nfunction createTableSection( sectionName, tableElement, conversionApi ) {\n\tconst tableChildElement = conversionApi.writer.createContainerElement( sectionName );\n\n\tconst insertPosition = conversionApi.writer.createPositionAt( tableElement, sectionName == 'tbody' ? 'end' : 0 );\n\n\tconversionApi.writer.insert( insertPosition, tableChildElement );\n\n\treturn tableChildElement;\n}\n\n// Removes an existing `<tbody>` or `<thead>` element if it is empty.\n//\n// @param {String} sectionName\n// @param {module:engine/view/element~Element} tableElement\n// @param {module:engine/conversion/downcastdispatcher~DowncastConversionApi} conversionApi\nfunction removeTableSectionIfEmpty( sectionName, tableElement, conversionApi ) {\n\tconst tableSection = getExistingTableSectionElement( sectionName, tableElement );\n\n\tif ( tableSection && tableSection.childCount === 0 ) {\n\t\tconversionApi.writer.remove( conversionApi.writer.createRangeOn( tableSection ) );\n\t}\n}\n\n// Moves view table rows associated with passed model rows to the provided table section element.\n//\n// **Note** This method will skip not converted table rows.\n//\n// @param {Array.<module:engine/model/element~Element>} rowsToMove\n// @param {module:engine/view/element~Element} viewTableSection\n// @param {module:engine/conversion/downcastdispatcher~DowncastConversionApi} conversionApi\n// @param {Number|'end'|'before'|'after'} offset Offset or one of the flags.\nfunction moveViewRowsToTableSection( rowsToMove, viewTableSection, conversionApi, offset ) {\n\tfor ( const tableRow of rowsToMove ) {\n\t\tconst viewTableRow = conversionApi.mapper.toViewElement( tableRow );\n\n\t\t// View table row might be not yet converted - skip it as it will be properly created by cell converter later on.\n\t\tif ( viewTableRow ) {\n\t\t\tconversionApi.writer.move(\n\t\t\t\tconversionApi.writer.createRangeOn( viewTableRow ),\n\t\t\t\tconversionApi.writer.createPositionAt( viewTableSection, offset )\n\t\t\t);\n\t\t}\n\t}\n}\n\n// Properly finds '<table>' element inside `<figure>` widget.\n//\n// @param {module:engine/view/element~Element} viewFigure\nfunction getViewTable( viewFigure ) {\n\tfor ( const child of viewFigure.getChildren() ) {\n\t\tif ( child.name === 'table' ) {\n\t\t\treturn child;\n\t\t}\n\t}\n}\n\n// Checks if element has any attribute set.\n//\n// @param {module:engine/model/element~Element element\n// @returns {Boolean}\nfunction hasAnyAttribute( element ) {\n\treturn !![ ...element.getAttributeKeys() ].length;\n}\n"]}]}